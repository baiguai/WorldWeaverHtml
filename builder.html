<!DOCTYPE html><html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WorldWeaver Builder</title>

    <!--
        Formatting notes:
        This code is formatted for indentation level folding.
        There are sections indented between comments, so that they
        remain collapsed at certain levels, to make code navigation
        and reading easier.
    -->

    <!-- Styles -->
        <style>
            html, body {
                height: 100%;
                margin: 0;
                padding: 0;
            }

            body {
                background-color: black;
                color: white;
                font-family: monospace;
                margin: 0;
                display: flex;
                flex-direction: column;
                height: 100dvh; /* better on mobile than 100vh */
            }

            /* Initially hide the admin interface */
            #admin-interface {
                flex: 1;
                display: flex;
                overflow: hidden; /* Prevent the outer from scrolling */
            }

            #treeview {
                display: flex;
                flex-direction: column;
                width: 400px;
                border-right: 1px solid white;
                padding: 10px;
                resize: horizontal;
                min-width: 100px;
                max-width: 50%;
                max-height: 100vh;
                overflow-y: auto;
                overflow-x: hidden;
            }

            #treeview ul {
                list-style: none;
                padding-left: 10px;
                overflow-y: auto;
                overflow-x: hidden;
            }

            #treeview li {
                cursor: pointer;
                padding: 5px;
            }

            .tree-toggle {
                width: 1em;
                text-align: center;
                font-weight: bold;
                color: #ccc;
            }

            #resizer {
                width: 5px;
                cursor: ew-resize;
                background-color: #ccc;
            }

            #details {
                flex: 1;
                padding: 10px;
                overflow-y: auto; /* <-- Add this */
                max-height: 100vh;
            }

            #admin-input-container {
                display: none;
                padding: 10px;
                background: black;
                border-top: 1px solid white;
            }

            #admin-input {
                width: 100%;
                background: black;
                color: white;
                border: none;
                padding: 10px;
                font-size: 1rem;
                font-family: monospace;
            }

            #admin-input:focus {
                outline: none;
            }

            #editor-container {
                display: none;
                flex: 1;
                padding: 10px;
                flex-direction: column;
            }

            #editor {
                flex: 1;
                background: black;
                color: white;
                border: 1px solid white;
                padding: 10px;
                font-size: 1rem;
                font-family: monospace;
                white-space: pre;
                overflow-y: auto;
            }

            #editor-close {
                align-self: flex-end;
                cursor: pointer;
                padding: 5px;
                color: red;
            }

            .link {
                cursor: pointer;
                text-decoration: underline;
            }
        </style>
    <!-- End Styles -->
</head>
<body>
    <div id="admin-interface" style="display: flex;">
        <div id="treeview"></div>
        <div id="resizer"></div>
        <div id="details" style="display: block;">
            <p><strong>Element Type:</strong><span id="element-type-parent"><span id="element-type" class="link">move</span></span></p>
            <p><strong>Element Key:</strong> <span id="element-key" class="link">k3gzbw6wmpqm95difm9</span></p>
            <p><strong>Name:</strong> <span id="element-name" class="link">GoldRoomDoor Action</span></p>
            <p><strong>Parent Key:</strong> <select id="parentSelect"><option value="null">No Parent</option><option value="game">Sample Game</option><option value="player"></option><option value="9wh0ai7glyhm8zq92fn">error</option><option value="nyoy47hnhtgm8zqaoi8">die message</option><option value="ym8tqvff76im91ooiy7">Attack Player</option><option value="tydkk947zvpm91op8ta">Attack</option><option value="long-sword_01">Long Sword</option><option value="3ielqbe2ltm91oyuf9">Global</option><option value="69lyn6u2u6nm91p0qv7">Title</option><option value="vl9tfy7wmkm91p1baj">show game title</option><option value="du2fxwfitpum91p248p">Stats</option><option value="6tqadr9itmpm91p2w5t">show stats</option><option value="0e9uq8d1xdim91p5y52">Inventory</option><option value="pohxz1iocgm91p6pom">show inventory</option><option value="w97g79kzvugm91p7k05">Arm</option><option value="51w1x5oxgt3m91p86i4">set armed weapon</option><option value="at73dh77pchm92hdikb">ROOMS</option><option value="home">Testing Home Room</option><option value="3yiz09d87evm92hgek0">Enter Message</option><option value="n1oy3odne3dm92hiusl">Look</option><option value="gos1iqg1rgqm92hjg25">Look Msg</option><option value="xhxecxcl42lm92iow8c">Navigation</option><option value="tr9whrpn83m92ipps2">Nav Msg</option><option value="zfofgknktfkm92iqoxe">INJECTIONS</option><option value="inj_look">Inj Look</option><option value="xs69bo34pndm92isgbk">Inj Look Action</option><option value="r7eqlu5a1om92itw47">Look Inj</option><option value="suli02fs0cm92js21q">Start Screen</option><option value="gold_room">Gold Room</option><option value="csgxp4xttqjm95dfyhv">enter message</option><option value="33qw3awzi5am95dh8zu" selected="">GoldRoom Door</option></select></p>
            <p><strong>Syntax:</strong> <span id="syntax-caption" class="link">Click to Edit</span></p>
            <p><strong>Logic:</strong> <span id="logic-field" class="link">gold_room</span></p>
            <p><strong>Output:</strong> <span id="output-field" class="link">You have decided to test receiving money.</span></p>
            <p><strong>Tags:</strong> <span id="tags-field" class="link">[player]</span></p>
            <p><strong>Repeat:</strong> <span id="repeat-field-parent"><span id="repeat-field" class="link">Click to Edit</span><span></span></span></p>
            <p><strong>Active:</strong> <span><input id="element-active" type="checkbox" checked=""></span></p>
            <p><strong>Sort:</strong> <span id="sort-field" class="link">Click to Edit</span></p>
            <br>
            <p><span id="delete-element" class="link">Delete</span></p>
        </div>
        <div id="editor-container" style="display: none;">
            <div id="editor-close">X</div>
            <textarea id="editor"></textarea>
        </div>
    </div>
    <div id="admin-input-container" style="display: flex;">
        <input type="text" id="admin-input">
    </div>

<div id="regexDlg" style="display:none; position:fixed; background:#000; color: #fff; border:1px solid #ccc; padding:1em; width: 70%; height: 70%; top: 50%; left: 50%; transform: translate(-50%, -50%);">
    <div id="modalContent" style="overflow: auto; max-height: calc(100% - 40px);">
        <h2>Regex Library</h2>
        <div id="regexTable"></div>
    </div>
    <button onclick="closeRegexLibrary()" style="margin-top: 8px;">Close</button>
</div>

    <div id="databaseModal" style="background: #000; color: #fff; display:none; position:fixed; top:10%; left:10%; width:80%; height:80%; border:2px solid #444; z-index:1000; padding:10px; overflow:auto; box-shadow:0 0 15px rgba(0,0,0,0.5);">
        <button onclick="copyDatabase()" style="float:right; margin-left:10px;">Copy</button>
        <button onclick="closeDatabaseModal()" style="float:right;">Close</button>
        <h3>Database JSON</h3>
        <textarea id="databaseText" style="background: #000; color: #fff; width:100%; height:85%; font-family:monospace;"></textarea>
    </div>




    <script>
        // !@! Database
        let database = [
  {"ElementType":"action","ElementKey":"ie4s113irb7mb1zxsli","Name":"","ParentKey":"5di50lsrev2mb1zxsli","Syntax":"","Logic":"[player]((stats))","Output":"Stats:","Tags":"!_list","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"input","ElementKey":"5di50lsrev2mb1zxsli","Name":"","ParentKey":"global01","Syntax":"(stats)","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"action","ElementKey":"5d5mgjpm2bcmb1zxsli","Name":"","ParentKey":"72fy1l9touymb1zxsli","Syntax":"","Logic":"[player]((inventory))","Output":"Inventory:","Tags":"!_list|!_bullet","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"input","ElementKey":"72fy1l9touymb1zxsli","Name":"","ParentKey":"global01","Syntax":"(inventory|inv)","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"set","ElementKey":"ogrddr8z8ytmb1zxsli","Name":"","ParentKey":"7dea5v7d9oimb1zxsli","Syntax":"","Logic":"player_armed","Output":"","Tags":"!_arm","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"input","ElementKey":"7dea5v7d9oimb1zxsli","Name":"","ParentKey":"global01","Syntax":"(arm .*)","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"global","ElementKey":"global01","Name":"","ParentKey":"root","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"attribute","ElementKey":"14gtojrx9dxlmb1zxsli","Name":"","ParentKey":"player","Syntax":"","Logic":"","Output":"[rand:3|5]","Tags":"stats_dice","Repeat":"","RepeatIndex":"0","Active":"true","Sort":4},{"ElementType":"attribute","ElementKey":"xwh2lgzugmnmb1zxsli","Name":"","ParentKey":"player","Syntax":"","Logic":"","Output":"[rand:4|6]","Tags":"money_dice","Repeat":"","RepeatIndex":"0","Active":"true","Sort":4},{"ElementType":"attribute","ElementKey":"skikgiu7yzsmb1zxsli","Name":"","ParentKey":"player","Syntax":"","Logic":"","Output":"[rand:<<[self]((stats_dice))>>|6]","Tags":"life_dice","Repeat":"","RepeatIndex":"0","Active":"true","Sort":4},{"ElementType":"attribute","ElementKey":"zudfbttomnmb1zxsli","Name":"","ParentKey":"player","Syntax":"","Logic":"","Output":"[rand:<<[self]((stats_dice))>>|4]","Tags":"armor_dice","Repeat":"","RepeatIndex":"0","Active":"true","Sort":4},{"ElementType":"attribute","ElementKey":"tkrv6w385afmb1zxsli","Name":"","ParentKey":"player","Syntax":"","Logic":"","Output":"[rand:<<[self]((stats_dice))>>|5]","Tags":"strength_dice","Repeat":"","RepeatIndex":"0","Active":"true","Sort":4},{"ElementType":"attribute","ElementKey":"mzwp3776i9mb1zxsli","Name":"","ParentKey":"player","Syntax":"","Logic":"","Output":"[rand:<<[self]((stats_dice))>>|5]","Tags":"int_dice","Repeat":"","RepeatIndex":"0","Active":"true","Sort":4},{"ElementType":"attribute","ElementKey":"cte7gtjaw7mb1zxsli","Name":"","ParentKey":"player","Syntax":"","Logic":"","Output":"[rand:<<[self]((stats_dice))>>|5]","Tags":"cunning_dice","Repeat":"","RepeatIndex":"0","Active":"true","Sort":4},{"ElementType":"attribute","ElementKey":"wrhmb0iw1ycmb1zxsli","Name":"","ParentKey":"player","Syntax":"","Logic":"","Output":"[rand:<<[self]((money_dice))>>|9]","Tags":"gold_dice","Repeat":"","RepeatIndex":"0","Active":"true","Sort":4},{"ElementType":"attribute","ElementKey":"z87q9u6bmf8mb1zxsli","Name":"Life","ParentKey":"player","Syntax":"","Logic":"","Output":"[roll:(8)<<[self]((life_dice))>>d6]","Tags":"stats|life","Repeat":"","RepeatIndex":"0","Active":"true","Sort":4},{"ElementType":"attribute","ElementKey":"fl9vq2y13mhmb1zxsli","Name":"","ParentKey":"player","Syntax":"","Logic":"","Output":"[player]((life))","Tags":"maxlife","Repeat":"","RepeatIndex":"0","Active":"true","Sort":4},{"ElementType":"attribute","ElementKey":"wgrl3weae8mb1zxsli","Name":"Armor Rating","ParentKey":"player","Syntax":"","Logic":"","Output":"[roll:(6)<<[self]((armor_dice))>>d6+3]","Tags":"stats|!_armor","Repeat":"","RepeatIndex":"0","Active":"true","Sort":4},{"ElementType":"attribute","ElementKey":"f3ugj6pa62gmb1zxsli","Name":"Strength","ParentKey":"player","Syntax":"","Logic":"","Output":"[roll:(6)<<[self]((strength_dice))>>d6]","Tags":"stats","Repeat":"","RepeatIndex":"0","Active":"true","Sort":4},{"ElementType":"attribute","ElementKey":"ieio8fudkgemb1zxsli","Name":"Intelligence","ParentKey":"player","Syntax":"","Logic":"","Output":"[roll:(6)<<[self]((int_dice))>>d6]","Tags":"stats","Repeat":"","RepeatIndex":"0","Active":"true","Sort":4},
  {"ElementType":"attribute","ElementKey":"qh0hihthbvhmb1zxsli","Name":"Cunning","ParentKey":"player","Syntax":"","Logic":"","Output":"[roll:(6)<<[self]((cunning_dice))>>d6]","Tags":"stats","Repeat":"","RepeatIndex":"0","Active":"true","Sort":4},{"ElementType":"attribute","ElementKey":"zy9dt3w05x8mb1zxsli","Name":"Gold","ParentKey":"player","Syntax":"","Logic":"","Output":"[roll:<<[self]((gold_dice))>>d8]","Tags":"stats|gold","Repeat":"","RepeatIndex":"0","Active":"true","Sort":4},{"ElementType":"attribute","ElementKey":"txfqu7bmel8mb1zxsli","Name":"Armed Weapon","ParentKey":"player","Syntax":"","Logic":"","Output":"long-sword_01","Tags":"!_armed|stats|name","Repeat":"","RepeatIndex":"0","Active":"true","Sort":4},{"ElementType":"attribute","ElementKey":"experience","Name":"Experience","ParentKey":"player","Syntax":"","Logic":"","Output":"0","Tags":"experience|stats","Repeat":"","RepeatIndex":"0","Active":"true","Sort":4},{"ElementType":"attribute","ElementKey":"n1p2vlmqmymb1zxsli","Name":"","ParentKey":"player","Syntax":"","Logic":"","Output":"5","Tags":"heal_rounds","Repeat":"","RepeatIndex":"0","Active":"true","Sort":4},{"ElementType":"attribute","ElementKey":"1r5tv8xiwe7mb1zxsli","Name":"","ParentKey":"player","Syntax":"","Logic":"","Output":"0","Tags":"cur_heal_round","Repeat":"","RepeatIndex":"0","Active":"true","Sort":4},{"ElementType":"attribute","ElementKey":"k7898j46r17mb1zxsli","Name":"Quest","ParentKey":"player","Syntax":"","Logic":"","Output":"","Tags":"stats|quest","Repeat":"","RepeatIndex":"0","Active":"true","Sort":4},{"ElementType":"attribute","ElementKey":"qb47l674upmb1zxsli","Name":"","ParentKey":"kaauhwoe57mb1zxsli","Syntax":"","Logic":"","Output":"[player]","Tags":"target","Repeat":"","RepeatIndex":"0","Active":"true","Sort":4},{"ElementType":"attack","ElementKey":"kaauhwoe57mb1zxsli","Name":"","ParentKey":"wcrwgpq1armb1zxsli","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":4},{"ElementType":"attackplayer","ElementKey":"wcrwgpq1armb1zxsli","Name":"","ParentKey":"player","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":4},{"ElementType":"attribute","ElementKey":"9pmyny7fqzhmb1zxsli","Name":"Damage","ParentKey":"long-sword_01","Syntax":"","Logic":"[rand:4|12]","Output":"","Tags":"!_damage","Repeat":"","RepeatIndex":"0","Active":"true","Sort":4},{"ElementType":"attribute","ElementKey":"7y71mn2o07fmb1zxsli","Name":"","ParentKey":"long-sword_01","Syntax":"","Logic":"","Output":"a Long Sword","Tags":"title","Repeat":"","RepeatIndex":"0","Active":"true","Sort":4},{"ElementType":"object","ElementKey":"long-sword_01","Name":"Long Sword","ParentKey":"player","Syntax":"\\b(?:your\\s+)?long\\s+sword\\b","Logic":"","Output":"","Tags":"inventory|!_weapon","Repeat":"","RepeatIndex":"0","Active":"true","Sort":4},{"ElementType":"player","ElementKey":"player","Name":"","ParentKey":"home","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":4},{"ElementType":"attribute","ElementKey":"cs8rfhunr3nmb1zxsli","Name":"","ParentKey":"tplt_syntax","Syntax":"","Logic":"","Output":"^l(ook( around)?)?$","Tags":"look","Repeat":"","RepeatIndex":"0","Active":"true","Sort":7},{"ElementType":"attribute","ElementKey":"bprrbqd878jmb1zxsli","Name":"","ParentKey":"tplt_syntax","Syntax":"","Logic":"","Output":".*key.*","Tags":"key_id","Repeat":"","RepeatIndex":"0","Active":"true","Sort":7},{"ElementType":"attribute","ElementKey":"d8rarcel1rrmb1zxsli","Name":"","ParentKey":"tplt_syntax","Syntax":"","Logic":"","Output":"(spear).*","Tags":"spear_id","Repeat":"","RepeatIndex":"0","Active":"true","Sort":7},{"ElementType":"attribute","ElementKey":"w0tzbc7w4aemb1zxsli","Name":"","ParentKey":"tplt_syntax","Syntax":"","Logic":"","Output":"^(take|pick up)( the)?( gold)? coin","Tags":"coin_take","Repeat":"","RepeatIndex":"0","Active":"true","Sort":7},{"ElementType":"attribute","ElementKey":"led7hvo036lmb1zxslj","Name":"","ParentKey":"tplt_syntax","Syntax":"","Logic":"","Output":"^(take|pick up)( the)? key$","Tags":"key_take","Repeat":"","RepeatIndex":"0","Active":"true","Sort":7},{"ElementType":"attribute","ElementKey":"09gapnui43njmb1zxslj","Name":"","ParentKey":"tplt_syntax","Syntax":"","Logic":"","Output":"^(take|pick up)( the)? spear$","Tags":"spear_take","Repeat":"","RepeatIndex":"0","Active":"true","Sort":7},
  {"ElementType":"attribute","ElementKey":"qirkmygl1vtmb1zxslj","Name":"","ParentKey":"tplt_syntax","Syntax":"","Logic":"","Output":"(drop.*spear)","Tags":"spear_drop","Repeat":"","RepeatIndex":"0","Active":"true","Sort":7},{"ElementType":"attribute","ElementKey":"i4ev3jqndlmb1zxslj","Name":"","ParentKey":"tplt_syntax","Syntax":"","Logic":"","Output":"put.*in.*box","Tags":"box_put","Repeat":"","RepeatIndex":"0","Active":"true","Sort":7},{"ElementType":"attribute","ElementKey":"4r0y0m1z2iumb1zxslj","Name":"","ParentKey":"tplt_syntax","Syntax":"","Logic":"","Output":"examine.*box|x.*box","Tags":"box_examine","Repeat":"","RepeatIndex":"0","Active":"true","Sort":7},{"ElementType":"attribute","ElementKey":"lif41bht839mb1zxslj","Name":"","ParentKey":"tplt_syntax","Syntax":"","Logic":"","Output":"^(push|press)( the)?( green)? button$","Tags":"greenbutton_push","Repeat":"","RepeatIndex":"0","Active":"true","Sort":7},{"ElementType":"attribute","ElementKey":"s604aarrummb1zxslj","Name":"","ParentKey":"tplt_syntax","Syntax":"","Logic":"","Output":"^(push|press)( the)?( red)? button$","Tags":"redbutton_push","Repeat":"","RepeatIndex":"0","Active":"true","Sort":7},{"ElementType":"attribute","ElementKey":"3i2ry3bqcjgmb1zxslj","Name":"","ParentKey":"tplt_syntax","Syntax":"","Logic":"","Output":"(attack.*rat|!.*rat)","Tags":"rat_attack","Repeat":"","RepeatIndex":"0","Active":"true","Sort":7},{"ElementType":"object","ElementKey":"tplt_syntax","Name":"","ParentKey":"root","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":7},{"ElementType":"attribute","ElementKey":"mesv4vk78b9mb1zxslj","Name":"","ParentKey":"jjll547py5amb1zxslj","Syntax":"","Logic":"","Output":"admin","Tags":"!_adminpass","Repeat":"","RepeatIndex":"0","Active":"true","Sort":8},{"ElementType":"attribute","ElementKey":"yxc12erx2opmb1zxslj","Name":"","ParentKey":"jjll547py5amb1zxslj","Syntax":"","Logic":"","Output":"\nI don't understand what you are trying to do.","Tags":"!_error","Repeat":"","RepeatIndex":"0","Active":"true","Sort":8},{"ElementType":"attribute","ElementKey":"68leyefxzwnmb1zxslj","Name":"","ParentKey":"jjll547py5amb1zxslj","Syntax":"","Logic":"","Output":"look","Tags":"!_defact","Repeat":"","RepeatIndex":"0","Active":"true","Sort":8},{"ElementType":"message","ElementKey":"pyx22xm04mnmb1zxslj","Name":"","ParentKey":"jjll547py5amb1zxslj","Syntax":"","Logic":"","Output":"\nYou have died.","Tags":"!_die","Repeat":"","RepeatIndex":"0","Active":"true","Sort":8},{"ElementType":"message","ElementKey":"nxr9i5gle1mb1zxslj","Name":"","ParentKey":"jjll547py5amb1zxslj","Syntax":"","Logic":"","Output":"\n\nWelcome to\n\n\n▓█████▄  ▄▄▄       ██▀███   ██ ▄█▀\n▒██▀ ██▌▒████▄    ▓██ ▒ ██▒ ██▄█▒\n░██   █▌▒██  ▀█▄  ▓██ ░▄█ ▒▓███▄░\n░▓█▄   ▌░██▄▄▄▄██ ▒██▀▀█▄  ▓██ █▄\n░▒████▓  ▓█   ▓██▒░██▓ ▒██▒▒██▒ █▄\n▒▒▓  ▒  ▒▒   ▓▒█░░ ▒▓ ░▒▓░▒ ▒▒ ▓▒\n░ ▒  ▒   ▒   ▒▒ ░  ░▒ ░ ▒░░ ░▒ ▒░\n░ ░  ░   ░   ▒     ░░   ░ ░ ░░ ░\n░          ░  ░   ░     ░  ░\n░\n█     █░ ▒█████   ██▀███   ██▓    ▓█████▄\n▓█░ █ ░█░▒██▒  ██▒▓██ ▒ ██▒▓██▒    ▒██▀ ██▌\n▒█░ █ ░█ ▒██░  ██▒▓██ ░▄█ ▒▒██░    ░██   █▌\n░█░ █ ░█ ▒██   ██░▒██▀▀█▄  ▒██░    ░▓█▄   ▌\n░░██▒██▓ ░ ████▓▒░░██▓ ▒██▒░██████▒░▒████▓\n░ ▓░▒ ▒  ░ ▒░▒░▒░ ░ ▒▓ ░▒▓░░ ▒░▓  ░ ▒▒▓  ▒\n▒ ░ ░    ░ ▒ ▒░   ░▒ ░ ▒░░ ░ ▒  ░ ░ ▒  ▒\n░   ░  ░ ░ ░ ▒    ░░   ░   ░ ░    ░ ░  ░\n░        ░ ░     ░         ░  ░   ░\n░\n\n\n","Tags":"!_start","Repeat":"","RepeatIndex":"0","Active":"true","Sort":8},{"ElementType":"game","ElementKey":"jjll547py5amb1zxslj","Name":"Sample Game","ParentKey":"root","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":8},{"ElementType":"macro","ElementKey":"tr01","Name":"","ParentKey":"root","Syntax":"","Logic":"","Output":"l|~|coin|~|take coin|~|home|~|tests|~|home","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":9},{"ElementType":"attribute","ElementKey":"428tvz1nz5cmb1zxslj","Name":"","ParentKey":"npc_rat","Syntax":"","Logic":"[rand:3|4]","Output":"","Tags":"stats_dice","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"attribute","ElementKey":"4ntwxkwbbhgmb1zxslj","Name":"","ParentKey":"npc_rat","Syntax":"","Logic":"","Output":"[rand:<<[self]((stats_dice))>>|4]","Tags":"life_roll","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"attribute","ElementKey":"kks1r6khremb1zxslj","Name":"","ParentKey":"npc_rat","Syntax":"","Logic":"","Output":"[rand:<<[self]((stats_dice))>>|5]","Tags":"armor_roll","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"attribute","ElementKey":"4dgowjclpmamb1zxslj","Name":"Life","ParentKey":"npc_rat","Syntax":"","Logic":"","Output":"[rand:<<[self]((stats_dice))>>|4]","Tags":"stats|life","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"attribute","ElementKey":"hdfklsi2bqmb1zxslj","Name":"","ParentKey":"npc_rat","Syntax":"","Logic":"","Output":"[roll:(6)<<[self]((armor_roll))>>d4+3]","Tags":"stats|!_armor","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"attribute","ElementKey":"zucs2hobs5omb1zxslj","Name":"","ParentKey":"npc_rat","Syntax":"","Logic":"","Output":"rat_claws_01","Tags":"!_armed|name","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},
  {"ElementType":"attribute","ElementKey":"1lihs3klw4smb1zxslj","Name":"","ParentKey":"npc_rat","Syntax":"","Logic":"","Output":"\nYou have hit the rat.\n","Tags":"!_hitmsg","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"attribute","ElementKey":"yabhfznjv7pmb1zxslj","Name":"","ParentKey":"npc_rat","Syntax":"","Logic":"","Output":"\nYou have attacked the rat, but missed.\n","Tags":"!_missmsg","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"attribute","ElementKey":"2lgdzmpqobimb1zxslj","Name":"","ParentKey":"npc_rat","Syntax":"","Logic":"","Output":"\nYou have killed the rat.\n","Tags":"!_killmsg","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"attribute","ElementKey":"z8pbbjotqecmb1zxslj","Name":"","ParentKey":"npc_rat","Syntax":"","Logic":"","Output":"\nThe rat has attacked you, but missed.\n","Tags":"!_missplayermsg","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"message","ElementKey":"lp2rzpjcnuomb1zxslj","Name":"","ParentKey":"7xwma2vm2e8mb1zxslj","Syntax":"","Logic":"","Output":"\n\nYou see a rat.\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"look","ElementKey":"7xwma2vm2e8mb1zxslj","Name":"","ParentKey":"npc_rat","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"attack","ElementKey":"1go2fdr4x7ymb1zxslj","Name":"","ParentKey":"myj25uuo48omb1zxslj","Syntax":"","Logic":"[self]","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"input","ElementKey":"myj25uuo48omb1zxslj","Name":"","ParentKey":"npc_rat","Syntax":"[tplt_syntax]((rat_attack))","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"attribute","ElementKey":"ocwvqgtthfnmb1zxslj","Name":"","ParentKey":"rat_claws_01","Syntax":"","Logic":"[rand:4|9]","Output":"","Tags":"!_damage","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"attribute","ElementKey":"qja8s9a2o4amb1zxslj","Name":"","ParentKey":"rat_claws_01","Syntax":"","Logic":"","Output":"rat claws","Tags":"title","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"object","ElementKey":"rat_claws_01","Name":"","ParentKey":"npc_rat","Syntax":"","Logic":"","Output":"","Tags":"!_weapon","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"npc","ElementKey":"npc_rat","Name":"","ParentKey":"root","Syntax":"","Logic":"","Output":"","Tags":"enemy","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"enter_message","ElementKey":"3349ar1unfamb1zxslj","Name":"","ParentKey":"arming_room","Syntax":"","Logic":"","Output":"\nWelcome to the weapon arming room.\nThis is a place where you can pick up a weapon.\nOnce you have picked it up you can use:\n\narm [weapon]\n\nIf you drop that armed weapon, you should automatically be armed\nwith any other weapon you are carrying.\nIf you have no weapons, you will deal a very low, empty hand\namount of damage in fights.\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"message","ElementKey":"mtxbz8hcy6emb1zxslj","Name":"","ParentKey":"1t9kzkewk9zmb1zxslj","Syntax":"","Logic":"","Output":"\nYou look around...\nYou are in a room where you can pick up a weapon.\nOnce you have picked it up you can use:\n\narm [weapon]\n\nIf you drop that armed weapon, you should automatically be armed\nwith any other weapon you are carrying.\nIf you have no weapons, you will deal a very low, empty hand\namount of damage in fights.\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"look","ElementKey":"1t9kzkewk9zmb1zxslj","Name":"","ParentKey":"arming_room","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"message","ElementKey":"9li1ctir1xamb1zxslj","Name":"","ParentKey":"9rsqf157rtimb1zxslj","Syntax":"","Logic":"","Output":"\n\nNavigation:\nHome\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"navigation","ElementKey":"9rsqf157rtimb1zxslj","Name":"","ParentKey":"arming_room","Syntax":"","Logic":"","Output":"","Tags":"look|enter_message","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"move","ElementKey":"yah2zmeytxnmb1zxslk","Name":"","ParentKey":"5zn08n2ayoumb1zxslk","Syntax":"","Logic":"home","Output":"You return to the testing home room.","Tags":"[player]","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"input","ElementKey":"5zn08n2ayoumb1zxslk","Name":"","ParentKey":"arming_room","Syntax":"(home)","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"action","ElementKey":"8e65u7n164lmb1zxslk","Name":"","ParentKey":"g5vy0890i9hmb1zxslk","Syntax":"","Logic":"look","Output":"","Tags":"!_type|room","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},
  {"ElementType":"input","ElementKey":"g5vy0890i9hmb1zxslk","Name":"","ParentKey":"arming_room","Syntax":"[tplt_syntax]((look))","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"room","ElementKey":"arming_room","Name":"Arming Room","ParentKey":"root","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"attribute","ElementKey":"00d2aj967mh6vmb1zxslk","Name":"","ParentKey":"spear_01","Syntax":"","Logic":"[roll:(4)2d8]","Output":"","Tags":"!damage","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"attribute","ElementKey":"3pql2ptw3m8mb1zxslk","Name":"","ParentKey":"spear_01","Syntax":"","Logic":"","Output":"a spear","Tags":"title","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"enter_message","ElementKey":"tk5g21dobdmb1zxslk","Name":"","ParentKey":"spear_01","Syntax":"","Logic":"","Output":"\nYou see a spear.\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"message","ElementKey":"k25dhlnhkemb1zxslk","Name":"","ParentKey":"vcza2w5tpqmb1zxslk","Syntax":"","Logic":"","Output":"\nYou see a spear.\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"logic","ElementKey":"ill7ivtw97mb1zxslk","Name":"","ParentKey":"vcza2w5tpqmb1zxslk","Syntax":"","Logic":"[self]parent = [room]","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"look","ElementKey":"vcza2w5tpqmb1zxslk","Name":"","ParentKey":"spear_01","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"move","ElementKey":"y6naaegpxbfmb1zxslk","Name":"","ParentKey":"do7lk9vt0zrmb1zxslk","Syntax":"","Logic":"[player]","Output":"\nYou take the spear.","Tags":"[self]","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"set","ElementKey":"kwswljrx62mb1zxslk","Name":"","ParentKey":"do7lk9vt0zrmb1zxslk","Syntax":"","Logic":"[self]tags","Output":"+inventory","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"input","ElementKey":"do7lk9vt0zrmb1zxslk","Name":"","ParentKey":"spear_01","Syntax":"[tplt_syntax]((spear_take))","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"move","ElementKey":"4ewfcf2eqgtmb1zxslk","Name":"","ParentKey":"x49o2ypaq5kmb1zxslk","Syntax":"","Logic":"[room]","Output":"\nYou drop the spear.","Tags":"[self]","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"set","ElementKey":"xhyom13t0nfmb1zxslk","Name":"","ParentKey":"x49o2ypaq5kmb1zxslk","Syntax":"","Logic":"[self]tags","Output":"-inventory","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"logic","ElementKey":"0rp5h8e1xibmb1zxslk","Name":"","ParentKey":"x49o2ypaq5kmb1zxslk","Syntax":"","Logic":"[self]parent = [player]elementkey","Output":"\nYou aren't carrying that item.","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"input","ElementKey":"x49o2ypaq5kmb1zxslk","Name":"","ParentKey":"spear_01","Syntax":"[tplt_syntax]((spear_drop))","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"object","ElementKey":"spear_01","Name":"Spear","ParentKey":"arming_room","Syntax":"[tplt_syntax]((spear_id))","Logic":"","Output":"","Tags":"!_weapon","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"logic","ElementKey":"d9l6570qy9dmb1zxslk","Name":"player_armed_spear","ParentKey":"9yigj2xkn06mb1zxslk","Syntax":"","Logic":"?[player]((!_armed)) = 'spear_01'","Output":"","Tags":"!_test","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"enter_message","ElementKey":"9yigj2xkn06mb1zxslk","Name":"","ParentKey":"test_room","Syntax":"","Logic":"","Output":"\nTo use this room, enter admin mode, create a macro.\nStore the macro in this game, then run it in test mode.\nEnsure that your macro passes through this room and the tests below will run\nwhen they are encountered.","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"message","ElementKey":"bk8af2ievwmmb1zxslk","Name":"","ParentKey":"27meejviz5xmb1zxslk","Syntax":"","Logic":"","Output":"\nTo use this room, enter admin mode, create a macro.\nStore the macro in this game, then run it in test mode.\nEnsure that your macro passes through this room and the tests below will run\nwhen they are encountered.","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"look","ElementKey":"27meejviz5xmb1zxslk","Name":"","ParentKey":"test_room","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},
  {"ElementType":"message","ElementKey":"9szp858irm9mb1zxslk","Name":"","ParentKey":"5xxkszgcadwmb1zxslk","Syntax":"","Logic":"","Output":"\n\nNavigation:\nHome\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"navigation","ElementKey":"5xxkszgcadwmb1zxslk","Name":"","ParentKey":"test_room","Syntax":"","Logic":"","Output":"","Tags":"look|enter_message","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"move","ElementKey":"9yobymfi8k8mb1zxslk","Name":"","ParentKey":"dz3b6yzbp07mb1zxslk","Syntax":"","Logic":"home","Output":"You return to the testing home room.","Tags":"[player]","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"input","ElementKey":"dz3b6yzbp07mb1zxslk","Name":"","ParentKey":"test_room","Syntax":"(home)","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"action","ElementKey":"akqz71pvl2mb1zxslk","Name":"","ParentKey":"869ydkn8x4mb1zxslk","Syntax":"","Logic":"look","Output":"","Tags":"!_type|room","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"input","ElementKey":"869ydkn8x4mb1zxslk","Name":"","ParentKey":"test_room","Syntax":"[tplt_syntax]((look))","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"room","ElementKey":"test_room","Name":"Test Room","ParentKey":"root","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"enter_message","ElementKey":"2x6jyo57eetmb1zxslk","Name":"","ParentKey":"fight_room","Syntax":"","Logic":"","Output":"\nYou step into the fighting arena!\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"message","ElementKey":"munkgw92frmb1zxsll","Name":"","ParentKey":"fc8mnzw4kdlmb1zxsll","Syntax":"","Logic":"","Output":"\nYou look around.\nYou are in the fight test room.\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"look","ElementKey":"fc8mnzw4kdlmb1zxsll","Name":"","ParentKey":"fight_room","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"message","ElementKey":"r7w3h7r053mb1zxsll","Name":"","ParentKey":"tz8h63ve2vmb1zxsll","Syntax":"","Logic":"","Output":"\n\nNavigation:\nHome\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"navigation","ElementKey":"tz8h63ve2vmb1zxsll","Name":"","ParentKey":"fight_room","Syntax":"","Logic":"","Output":"","Tags":"look|enter_message","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"move","ElementKey":"bkrxoq8nny6mb1zxsll","Name":"","ParentKey":"syc56m8bczkmb1zxsll","Syntax":"","Logic":"home","Output":"You return to the testing home room.","Tags":"[player]","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"input","ElementKey":"syc56m8bczkmb1zxsll","Name":"","ParentKey":"fight_room","Syntax":"(home)","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"action","ElementKey":"p0zcwlmdi5omb1zxsll","Name":"","ParentKey":"g0upl6x5yvrmb1zxsll","Syntax":"","Logic":"look","Output":"","Tags":"!_type|room","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"input","ElementKey":"g0upl6x5yvrmb1zxsll","Name":"","ParentKey":"fight_room","Syntax":"[tplt_syntax]((look))","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"room","ElementKey":"fight_room","Name":"Fight Room","ParentKey":"root","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"enter_message","ElementKey":"gx4k2lhqc2mb1zxsll","Name":"","ParentKey":"oxtpgqt7bbmb1zxsll","Syntax":"","Logic":"","Output":"\n\nYou see a red button in the center of the room.\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"message","ElementKey":"gwelyak7hh6mb1zxsll","Name":"","ParentKey":"57ai5lp25igmb1zxsll","Syntax":"","Logic":"","Output":"\n\nYou see a red button in the middle of the room.","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"look","ElementKey":"57ai5lp25igmb1zxsll","Name":"","ParentKey":"oxtpgqt7bbmb1zxsll","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},
  {"ElementType":"message","ElementKey":"tioprdy53kmb1zxsll","Name":"","ParentKey":"0jq1d47x6wvlmb1zxsll","Syntax":"","Logic":"","Output":"\n\nA rat appears!","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"action","ElementKey":"0jq1d47x6wvlmb1zxsll","Name":"","ParentKey":"t9xfgtwaaymb1zxsll","Syntax":"","Logic":"npc_rat","Output":"[room]","Tags":"!_spawn","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"input","ElementKey":"t9xfgtwaaymb1zxsll","Name":"","ParentKey":"oxtpgqt7bbmb1zxsll","Syntax":"[tplt_syntax]((redbutton_push))","Logic":"","Output":"\n\nYou've pressed the button.\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"message","ElementKey":"of7nsn83jyomb1zxsll","Name":"","ParentKey":"cyvuyxcfu47mb1zxsll","Syntax":"","Logic":"","Output":"\n\nNavigation:\nHome\nArming\nCoin\nFight\nFollows\nMessages\nPath\nPutting\nTests\nValues  (Special message values test)\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"navigation","ElementKey":"cyvuyxcfu47mb1zxsll","Name":"","ParentKey":"oxtpgqt7bbmb1zxsll","Syntax":"","Logic":"","Output":"","Tags":"look|enter_message","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"move","ElementKey":"f5snhselpzmb1zxsll","Name":"","ParentKey":"pvem48c1gtkmb1zxsll","Syntax":"","Logic":"home","Output":"You return to the testing home room.","Tags":"[player]","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"input","ElementKey":"pvem48c1gtkmb1zxsll","Name":"","ParentKey":"oxtpgqt7bbmb1zxsll","Syntax":"(home)","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"action","ElementKey":"9kbkqmi0bv4mb1zxsll","Name":"","ParentKey":"0ff1b6vxh0wgmb1zxsll","Syntax":"","Logic":"look","Output":"","Tags":"!_type|room","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"input","ElementKey":"0ff1b6vxh0wgmb1zxsll","Name":"","ParentKey":"oxtpgqt7bbmb1zxsll","Syntax":"[tplt_syntax]((look))","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"object","ElementKey":"oxtpgqt7bbmb1zxsll","Name":"","ParentKey":"fight_room","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"attribute","ElementKey":"7vjog22p7zymb1zxsll","Name":"","ParentKey":"messages_room","Syntax":"","Logic":"","Output":"1","Tags":"oth_idx","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"enter_message","ElementKey":"8fy007k3s3nmb1zxsll","Name":"","ParentKey":"messages_room","Syntax":"","Logic":"","Output":"\nWelcome to the message testing room.\nTo test the various message repeat options simply enter:\n\nlook\nor\nl\n\nrepeatedly.\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"message","ElementKey":"g1epqklu1cumb1zxsll","Name":"","ParentKey":"tsnghs8g2hnmb1zxsll","Syntax":"","Logic":"","Output":"\nYou look around...","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"look","ElementKey":"tsnghs8g2hnmb1zxsll","Name":"","ParentKey":"messages_room","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"message","ElementKey":"ylm85eh4uucmb1zxsll","Name":"","ParentKey":"hskx4oo1wemb1zxsll","Syntax":"","Logic":"","Output":"\n\nNavigation:\nHome\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"navigation","ElementKey":"hskx4oo1wemb1zxsll","Name":"","ParentKey":"messages_room","Syntax":"","Logic":"","Output":"","Tags":"look|enter_message","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"move","ElementKey":"ll1g1ag4x5mb1zxsll","Name":"","ParentKey":"hmlbe5uw12gmb1zxsll","Syntax":"","Logic":"home","Output":"You return to the testing home room.","Tags":"[player]","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"input","ElementKey":"hmlbe5uw12gmb1zxsll","Name":"","ParentKey":"messages_room","Syntax":"(home)","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"action","ElementKey":"lqon1zzcs2qmb1zxsll","Name":"","ParentKey":"wsnz81fowkamb1zxsll","Syntax":"","Logic":"look","Output":"","Tags":"!_type|room","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"input","ElementKey":"wsnz81fowkamb1zxsll","Name":"","ParentKey":"messages_room","Syntax":"[tplt_syntax]((look))","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},
  {"ElementType":"dev_note","ElementKey":"smrcfn38f8mb1zxsll","Name":"","ParentKey":"messages_room","Syntax":"","Logic":"","Output":"\nThis is a Dev Note. It should only show if you are in admin mode.\nIf you want to leave it in your messages.nrmn file, but don't want it to show,\nadd an active=false attribute.\n\nInactive Dev Notes WILL show if you use the _devnotes command however.","Tags":"Testing","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"dev_note","ElementKey":"etmza0rt60umb1zxsll","Name":"","ParentKey":"messages_room","Syntax":"","Logic":"","Output":"\nThis is an inactive Dev Note. It will only show when you are listing your Dev Notes using: _devnotes [Search Criteria]","Tags":"Testing","Repeat":"","RepeatIndex":"0","Active":"false","Sort":1},{"ElementType":"room","ElementKey":"messages_room","Name":"Messages Room","ParentKey":"root","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"enter_message","ElementKey":"su4r5fms7smb1zxsll","Name":"","ParentKey":"vzs8g386kxsmb1zxsll","Syntax":"","Logic":"","Output":"\nYou see a random message parchment.\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"message","ElementKey":"k2abns1x06mb1zxsll","Name":"","ParentKey":"9ae5m5flm77mb1zxsll","Syntax":"","Logic":"","Output":"\nOh! This message is so random.\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"message","ElementKey":"pwpknrtn6mb1zxsll","Name":"","ParentKey":"9ae5m5flm77mb1zxsll","Syntax":"","Logic":"","Output":"\nYet another random message!\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"message","ElementKey":"c3j3wiisj6mmb1zxsll","Name":"","ParentKey":"9ae5m5flm77mb1zxsll","Syntax":"","Logic":"","Output":"\nOh man, another random message!\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"message","ElementKey":"9ae5m5flm77mb1zxsll","Name":"Non Repeating Look Group","ParentKey":"kmcyuwsxvumb1zxsll","Syntax":"","Logic":"","Output":"\nThis is the message group.\nIt's random messages should show below:\n","Tags":"","Repeat":"random","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"look","ElementKey":"kmcyuwsxvumb1zxsll","Name":"","ParentKey":"vzs8g386kxsmb1zxsll","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"object","ElementKey":"vzs8g386kxsmb1zxsll","Name":"Random Repeating Parchment","ParentKey":"messages_room","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"enter_message","ElementKey":"9lev0f1fwkhmb1zxsll","Name":"","ParentKey":"m2z0q2oaanmb1zxsll","Syntax":"","Logic":"","Output":"\nYou see a repeating message parchment.\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":2},{"ElementType":"message","ElementKey":"3j1j0t2kczgmb1zxslm","Name":"","ParentKey":"l9xncecbm2rmb1zxslm","Syntax":"","Logic":"","Output":"\nThis is repeating message number 01\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":2},{"ElementType":"message","ElementKey":"gi478efloxdmb1zxslm","Name":"","ParentKey":"l9xncecbm2rmb1zxslm","Syntax":"","Logic":"","Output":"\nThis is repeating message number 02\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":2},{"ElementType":"message","ElementKey":"0rq30abhpfdkmb1zxslm","Name":"","ParentKey":"l9xncecbm2rmb1zxslm","Syntax":"","Logic":"","Output":"\nThis is repeating message number 03\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":2},{"ElementType":"message","ElementKey":"l9xncecbm2rmb1zxslm","Name":"Non Repeating Look Group","ParentKey":"2xsst7xv7wbmb1zxslm","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"repeat","RepeatIndex":"0","Active":"true","Sort":2},{"ElementType":"look","ElementKey":"2xsst7xv7wbmb1zxslm","Name":"","ParentKey":"m2z0q2oaanmb1zxsll","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":2},{"ElementType":"object","ElementKey":"m2z0q2oaanmb1zxsll","Name":"Repeating Parchment","ParentKey":"messages_room","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":2},{"ElementType":"enter_message","ElementKey":"cs8v9ucu7ojmb1zxslm","Name":"","ParentKey":"s8lvcjq7vpsmb1zxslm","Syntax":"","Logic":"","Output":"\nYou see an 'other' repeating message parchment.\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":3},{"ElementType":"message","ElementKey":"giedazxxxormb1zxslm","Name":"","ParentKey":"bhz4swb9aeamb1zxslm","Syntax":"","Logic":"","Output":"\nThis is 'other' message 01.\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":3},{"ElementType":"message","ElementKey":"yqfjr7yu8tfmb1zxslm","Name":"","ParentKey":"bhz4swb9aeamb1zxslm","Syntax":"","Logic":"","Output":"\nThis is 'other' message 02.\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":3},
  {"ElementType":"message","ElementKey":"ito76e6xvtmb1zxslm","Name":"","ParentKey":"bhz4swb9aeamb1zxslm","Syntax":"","Logic":"","Output":"\nThis is 'other' message 03.\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":3},{"ElementType":"message","ElementKey":"bhz4swb9aeamb1zxslm","Name":"Non Repeating Look Group","ParentKey":"dtl5xcdcsoemb1zxslm","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"[room]((oth_idx))","RepeatIndex":"0","Active":"true","Sort":3},{"ElementType":"look","ElementKey":"dtl5xcdcsoemb1zxslm","Name":"","ParentKey":"s8lvcjq7vpsmb1zxslm","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":3},{"ElementType":"object","ElementKey":"s8lvcjq7vpsmb1zxslm","Name":"OTHER Repeating Parchment","ParentKey":"messages_room","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":3},{"ElementType":"enter_message","ElementKey":"xip88esxsarmb1zxslm","Name":"","ParentKey":"q2z2a6sno0smb1zxslm","Syntax":"","Logic":"","Output":"\nYou see a non-repeating message parchment.\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":4},{"ElementType":"message","ElementKey":"vs6ezfeyhpmb1zxslm","Name":"","ParentKey":"6nfah6lcwpcmb1zxslm","Syntax":"","Logic":"","Output":"\nThis is non-repeating message number 01\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":4},{"ElementType":"message","ElementKey":"32pw7l4xicymb1zxslm","Name":"","ParentKey":"6nfah6lcwpcmb1zxslm","Syntax":"","Logic":"","Output":"\nThis is non-repeating message number 02\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":4},{"ElementType":"message","ElementKey":"duwushpa94mmb1zxslm","Name":"","ParentKey":"6nfah6lcwpcmb1zxslm","Syntax":"","Logic":"","Output":"\nThis is non-repeating message number 03\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":4},{"ElementType":"message","ElementKey":"6nfah6lcwpcmb1zxslm","Name":"Non Repeating Look Group","ParentKey":"9r5x4dfc5vsmb1zxslm","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"none","RepeatIndex":"0","Active":"true","Sort":4},{"ElementType":"look","ElementKey":"9r5x4dfc5vsmb1zxslm","Name":"","ParentKey":"q2z2a6sno0smb1zxslm","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":4},{"ElementType":"object","ElementKey":"q2z2a6sno0smb1zxslm","Name":"Non Repeating Parchment","ParentKey":"messages_room","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":4},{"ElementType":"attribute","ElementKey":"h3x56rmlypgmb1zxslm","Name":"","ParentKey":"specval_room","Syntax":"","Logic":"","Output":"false","Tags":"showthis","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"enter_message","ElementKey":"rfiv8unpdgmb1zxslm","Name":"","ParentKey":"specval_room","Syntax":"","Logic":"","Output":"\nIn this room you will see a message when you look around.\nIt will contain special values (Your player's name for example).","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"message","ElementKey":"usqvl6kowxmb1zxslm","Name":"","ParentKey":"lq8wnpcpq5mb1zxslm","Syntax":"","Logic":"","Output":"\nGreetings <<[player]name>>.\n\nIn this room:\n<?[room]((showthis)) = 'true'?>\nThis text should show - because 'showthis' is true.\n<else>\nORRR this text should show - because 'showthis' is false.\n</?>\n\n<?[room]((showthis)) = 'true'?>\nAnd this should show only when showthis is true.\n</?>\n\nThe following text will only show if the random value that is 'rolled'\nevery time you 'look around' is > 2.\n<?rdm_[roll:1d6] > '2'?>\nYou succeeded the roll!\n</?>","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"look","ElementKey":"lq8wnpcpq5mb1zxslm","Name":"","ParentKey":"specval_room","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"message","ElementKey":"3daifq1l7e5mb1zxslm","Name":"","ParentKey":"gzm11zmveuimb1zxslm","Syntax":"","Logic":"","Output":"\n\nNavigation:\nHome\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"navigation","ElementKey":"gzm11zmveuimb1zxslm","Name":"","ParentKey":"specval_room","Syntax":"","Logic":"","Output":"","Tags":"look|enter_message","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"move","ElementKey":"48p5ynb99ummb1zxslm","Name":"","ParentKey":"rj0bbjoy2ymb1zxslm","Syntax":"","Logic":"home","Output":"You return to the testing home room.","Tags":"[player]","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"input","ElementKey":"rj0bbjoy2ymb1zxslm","Name":"","ParentKey":"specval_room","Syntax":"(home)","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"action","ElementKey":"vvrnlwqdr4mb1zxslm","Name":"","ParentKey":"l849e46llmmb1zxslm","Syntax":"","Logic":"look","Output":"","Tags":"!_type|room","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},
  {"ElementType":"input","ElementKey":"l849e46llmmb1zxslm","Name":"","ParentKey":"specval_room","Syntax":"[tplt_syntax]((look))","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"room","ElementKey":"specval_room","Name":"Special Values Room","ParentKey":"root","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"set","ElementKey":"r0kzymqhzogmb1zxslm","Name":"","ParentKey":"2adpjtprje3mb1zxslm","Syntax":"","Logic":"[game]((game_started))","Output":"true","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":2},{"ElementType":"enter_message","ElementKey":"2adpjtprje3mb1zxslm","Name":"","ParentKey":"home","Syntax":"","Logic":"","Output":"\nWelcome to the WorldWeaver Testing Game.\n\nTo enter a test room simply enter its name.\n(No need to say \"go to\").\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":2},{"ElementType":"message","ElementKey":"ublxx202cqqmb1zxslm","Name":"","ParentKey":"hz0eowuxz5tmb1zxslm","Syntax":"","Logic":"","Output":"\nYou are in the testing room.\n\nTo enter a test room simply enter its name.\n(No need to say \"go to\").\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":2},{"ElementType":"look","ElementKey":"hz0eowuxz5tmb1zxslm","Name":"","ParentKey":"home","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":2},{"ElementType":"message","ElementKey":"fdc69h5ownmb1zxslm","Name":"","ParentKey":"kbqong7rrxgmb1zxslm","Syntax":"","Logic":"","Output":"\n\nNavigation:\nHome\nArming\nCoin\nFight\nFollows\nMessages\nPath\nPutting\nTests\nValues  (Special message values test)\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":2},{"ElementType":"navigation","ElementKey":"kbqong7rrxgmb1zxslm","Name":"","ParentKey":"home","Syntax":"","Logic":"","Output":"","Tags":"look|enter_message","Repeat":"","RepeatIndex":"0","Active":"true","Sort":2},{"ElementType":"action","ElementKey":"o2tm131bi28mb1zxslm","Name":"","ParentKey":"417f87n50numb1zxslm","Syntax":"","Logic":"look","Output":"","Tags":"!_type|room","Repeat":"","RepeatIndex":"0","Active":"true","Sort":2},{"ElementType":"input","ElementKey":"417f87n50numb1zxslm","Name":"","ParentKey":"home","Syntax":"[tplt_syntax]((look))","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":2},{"ElementType":"move","ElementKey":"k7drgxpudlmb1zxslm","Name":"","ParentKey":"170a0k5e7x3mb1zxslm","Syntax":"","Logic":"arming_room","Output":"\nYou have decided to test arming weapons.\n","Tags":"[player]","Repeat":"","RepeatIndex":"0","Active":"true","Sort":2},{"ElementType":"input","ElementKey":"170a0k5e7x3mb1zxslm","Name":"","ParentKey":"home","Syntax":"(arming)","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":2},{"ElementType":"move","ElementKey":"gy07k1eoq4umb1zxslm","Name":"","ParentKey":"k8cogjdpr5omb1zxslm","Syntax":"","Logic":"coin_room","Output":"\nYou have decided to test receiving money.\n","Tags":"[player]","Repeat":"","RepeatIndex":"0","Active":"true","Sort":2},{"ElementType":"input","ElementKey":"k8cogjdpr5omb1zxslm","Name":"","ParentKey":"home","Syntax":"(coin)","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":2},{"ElementType":"move","ElementKey":"gq0nry80umb1zxslm","Name":"","ParentKey":"ziw2llhyeggmb1zxslm","Syntax":"","Logic":"fight_room","Output":"\nYou have decided to test the fight room.\n","Tags":"[player]","Repeat":"","RepeatIndex":"0","Active":"true","Sort":2},{"ElementType":"input","ElementKey":"ziw2llhyeggmb1zxslm","Name":"","ParentKey":"home","Syntax":"(fight)","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":2},{"ElementType":"move","ElementKey":"gxda9uuqdhamb1zxslm","Name":"","ParentKey":"qerx7q3oq3mb1zxslm","Syntax":"","Logic":"follows_room","Output":"\nYou have decided to test the NPC follows the player room.\n","Tags":"[player]","Repeat":"","RepeatIndex":"0","Active":"true","Sort":2},{"ElementType":"input","ElementKey":"qerx7q3oq3mb1zxslm","Name":"","ParentKey":"home","Syntax":"(follows)","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":2},{"ElementType":"move","ElementKey":"uk153hudfzpmb1zxslm","Name":"","ParentKey":"4a644lmruv6mb1zxslm","Syntax":"","Logic":"messages_room","Output":"\nYou have decided to test messages.\n","Tags":"[player]","Repeat":"","RepeatIndex":"0","Active":"true","Sort":2},{"ElementType":"input","ElementKey":"4a644lmruv6mb1zxslm","Name":"","ParentKey":"home","Syntax":"(messages)","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":2},
  {"ElementType":"move","ElementKey":"4wu5yi09y3kmb1zxslm","Name":"","ParentKey":"mxr9plzesy8mb1zxslm","Syntax":"","Logic":"path_room","Output":"\nYou have decided to test the NPC follows a path room.\n","Tags":"[player]","Repeat":"","RepeatIndex":"0","Active":"true","Sort":2},{"ElementType":"input","ElementKey":"mxr9plzesy8mb1zxslm","Name":"","ParentKey":"home","Syntax":"(path)","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":2},{"ElementType":"move","ElementKey":"4edt4yu9x31mb1zxsln","Name":"","ParentKey":"4z1z98v6ihymb1zxsln","Syntax":"","Logic":"taking_room","Output":"\nYou have decided to test the putting room.\n","Tags":"[player]","Repeat":"","RepeatIndex":"0","Active":"true","Sort":2},{"ElementType":"input","ElementKey":"4z1z98v6ihymb1zxsln","Name":"","ParentKey":"home","Syntax":"(putting)","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":2},{"ElementType":"move","ElementKey":"qr2xbuxgsfbmb1zxsln","Name":"","ParentKey":"gk4jmrju7dbmb1zxsln","Syntax":"","Logic":"test_room","Output":"\nYou have decided to test the tests room.\n","Tags":"[player]","Repeat":"","RepeatIndex":"0","Active":"true","Sort":2},{"ElementType":"input","ElementKey":"gk4jmrju7dbmb1zxsln","Name":"","ParentKey":"home","Syntax":"(tests)","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":2},{"ElementType":"move","ElementKey":"peq0vwku4s9mb1zxsln","Name":"","ParentKey":"yio8arzn14omb1zxsln","Syntax":"","Logic":"specval_room","Output":"\nYou have decided to test special message values.\n","Tags":"[player]","Repeat":"","RepeatIndex":"0","Active":"true","Sort":2},{"ElementType":"input","ElementKey":"yio8arzn14omb1zxsln","Name":"","ParentKey":"home","Syntax":"(values)","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":2},{"ElementType":"room","ElementKey":"home","Name":"Testing Home Room","ParentKey":"root","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":2},{"ElementType":"enter_message","ElementKey":"i5uy4guxuhamb1zxsln","Name":"","ParentKey":"path_room","Syntax":"","Logic":"","Output":"\nYou have chosen to test the NPC Along a Path feature.\nIf you push the green button, the thief will begin moving.\n\nYou see a green button and a red button.\n\nIf you push the red button, it will stop traveling.\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"message","ElementKey":"mky7ifzqglfmb1zxsln","Name":"","ParentKey":"v9wpaqwhjdmb1zxsln","Syntax":"","Logic":"","Output":"\nYou look around.\nThere is a green button and a red button.\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"look","ElementKey":"v9wpaqwhjdmb1zxsln","Name":"","ParentKey":"path_room","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"message","ElementKey":"spwbvx7b5xsmb1zxsln","Name":"","ParentKey":"ee2dagtv26imb1zxsln","Syntax":"","Logic":"","Output":"\n\nNavigation:\nHome\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"navigation","ElementKey":"ee2dagtv26imb1zxsln","Name":"","ParentKey":"path_room","Syntax":"","Logic":"","Output":"","Tags":"look|enter_message","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"action","ElementKey":"8e4qcq25a0omb1zxsln","Name":"","ParentKey":"fmqzqoyq3akmb1zxsln","Syntax":"","Logic":"look","Output":"","Tags":"!_type|room","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"input","ElementKey":"fmqzqoyq3akmb1zxsln","Name":"","ParentKey":"path_room","Syntax":"[tplt_syntax]((look))","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"move","ElementKey":"c4ww2w63m2mb1zxsln","Name":"","ParentKey":"9u4fn8mpxpkmb1zxsln","Syntax":"","Logic":"home","Output":"You return to the testing home room.","Tags":"[player]","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"input","ElementKey":"9u4fn8mpxpkmb1zxsln","Name":"","ParentKey":"path_room","Syntax":"(home)","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"set","ElementKey":"th28kvpve5mb1zxsln","Name":"","ParentKey":"hp5lfn0midqmb1zxsln","Syntax":"","Logic":"[trv_path_ranger]active","Output":"true","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"message","ElementKey":"h3upz6trn2smb1zxsln","Name":"","ParentKey":"hp5lfn0midqmb1zxsln","Syntax":"","Logic":"","Output":"\nYou activate the ranger's travel.\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},
  {"ElementType":"input","ElementKey":"hp5lfn0midqmb1zxsln","Name":"","ParentKey":"path_room","Syntax":"[tplt_syntax]((greenbutton_push))","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"set","ElementKey":"1oezs8zlup1mb1zxsln","Name":"","ParentKey":"6hkjirxfpvrmb1zxsln","Syntax":"","Logic":"[trv_path_ranger]active","Output":"false","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"message","ElementKey":"wjt37tij4bmb1zxsln","Name":"","ParentKey":"6hkjirxfpvrmb1zxsln","Syntax":"","Logic":"","Output":"\nYou deactivate the ranger's travel.\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"input","ElementKey":"6hkjirxfpvrmb1zxsln","Name":"","ParentKey":"path_room","Syntax":"[tplt_syntax]((redbutton_push))","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"room","ElementKey":"path_room","Name":"NPC on a Path Test","ParentKey":"root","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"enter_message","ElementKey":"f7a14cesmxrmb1zxsln","Name":"","ParentKey":"7lob0ccmzn3mb1zxsln","Syntax":"","Logic":"","Output":"\nThe ranger is there.","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"message","ElementKey":"p7ds2e3nqgdmb1zxsln","Name":"","ParentKey":"a26s8slx14mb1zxsln","Syntax":"","Logic":"","Output":"\nYou see a ranger.\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"look","ElementKey":"a26s8slx14mb1zxsln","Name":"","ParentKey":"7lob0ccmzn3mb1zxsln","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"logic","ElementKey":"a10dmjjb30wmb1zxsln","Name":"","ParentKey":"8qd0kto92l8mb1zxsln","Syntax":"","Logic":"[self]((nav))active = 'true'","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"message","ElementKey":"8qd0kto92l8mb1zxsln","Name":"","ParentKey":"trv_path_ranger","Syntax":"","Logic":"","Output":"\nThe Ranger enters the room.\n","Tags":"!_enter","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"travel","ElementKey":"trv_path_ranger","Name":"","ParentKey":"7lob0ccmzn3mb1zxsln","Syntax":"","Logic":"[path|home|gold_room|home|path_room]","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"false","Sort":1},{"ElementType":"npc","ElementKey":"7lob0ccmzn3mb1zxsln","Name":"Traveling Ranger","ParentKey":"path_room","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"enter_message","ElementKey":"41bb0hbepmtmb1zxsln","Name":"","ParentKey":"coin_room","Syntax":"","Logic":"","Output":"\nYou are in an empty room.\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"message","ElementKey":"kj6p6f8zf9imb1zxsln","Name":"","ParentKey":"zixv0h7jqbemb1zxsln","Syntax":"","Logic":"","Output":"\nYou look around.\nYou are in a small room.\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"look","ElementKey":"zixv0h7jqbemb1zxsln","Name":"","ParentKey":"coin_room","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"message","ElementKey":"jxmc0k6tg3nmb1zxsln","Name":"","ParentKey":"4l2s5qeqz85mb1zxsln","Syntax":"","Logic":"","Output":"\n\nNavigation:\nHome\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"navigation","ElementKey":"4l2s5qeqz85mb1zxsln","Name":"","ParentKey":"coin_room","Syntax":"","Logic":"","Output":"","Tags":"look|enter_message","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"move","ElementKey":"v6km4zjxnh8mb1zxsln","Name":"","ParentKey":"eeiq3earbr7mb1zxsln","Syntax":"","Logic":"home","Output":"You return to the testing home room.","Tags":"[player]","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"input","ElementKey":"eeiq3earbr7mb1zxsln","Name":"","ParentKey":"coin_room","Syntax":"(home)","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"action","ElementKey":"y2u0tjfw41lmb1zxsln","Name":"","ParentKey":"p7b7ne96vbkmb1zxsln","Syntax":"","Logic":"look","Output":"","Tags":"!_type|room","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},
  {"ElementType":"input","ElementKey":"p7b7ne96vbkmb1zxsln","Name":"","ParentKey":"coin_room","Syntax":"[tplt_syntax]((look))","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"room","ElementKey":"coin_room","Name":"Coin Room","ParentKey":"root","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"attribute","ElementKey":"jpo9kxwfu3mb1zxsln","Name":"","ParentKey":"cmpr387694hmb1zxsln","Syntax":"","Logic":"","Output":"false","Tags":"moved","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"enter_message","ElementKey":"sdoau04d14rmb1zxsln","Name":"","ParentKey":"cmpr387694hmb1zxsln","Syntax":"","Logic":"","Output":"\nYou see a gold coin.","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"message","ElementKey":"c16e23r83amb1zxsln","Name":"","ParentKey":"ruikibizgfmb1zxsln","Syntax":"","Logic":"","Output":"\nYou see a gold coin.\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"logic","ElementKey":"vit1vbkm8qdmb1zxsln","Name":"","ParentKey":"ruikibizgfmb1zxsln","Syntax":"","Logic":"?[self]((moved)) = 'false'","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"look","ElementKey":"ruikibizgfmb1zxsln","Name":"","ParentKey":"cmpr387694hmb1zxsln","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"move","ElementKey":"anxz2isfclmb1zxsln","Name":"","ParentKey":"l2abfmzbmvmb1zxsln","Syntax":"","Logic":"!_limbo","Output":"\nYou take the gold coin.\n","Tags":"[self]","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"set","ElementKey":"mlb1j66ttbmb1zxsln","Name":"","ParentKey":"l2abfmzbmvmb1zxsln","Syntax":"","Logic":"[player]((gold))","Output":"+=1","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"input","ElementKey":"l2abfmzbmvmb1zxsln","Name":"","ParentKey":"cmpr387694hmb1zxsln","Syntax":"[tplt_syntax]((coin_take))","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"object","ElementKey":"cmpr387694hmb1zxsln","Name":"Gold Coin","ParentKey":"coin_room","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"enter_message","ElementKey":"uan9d9rqklmb1zxsln","Name":"","ParentKey":"follows_room","Syntax":"","Logic":"","Output":"\nYou have chosen to test the NPC Follows feature.\nIf you push the green button, the thief will follow you as you travel\nfrom room to room.\n\nYou see a green button and a red button.\n\nIf you push the red button, it will stop following you.\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"message","ElementKey":"lp3cdu2khkmb1zxsln","Name":"","ParentKey":"hhlyt0tmbwamb1zxsln","Syntax":"","Logic":"","Output":"\nYou look around.\nThere is a green button and a red button.\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"look","ElementKey":"hhlyt0tmbwamb1zxsln","Name":"","ParentKey":"follows_room","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"message","ElementKey":"3zx6e50tpzrmb1zxsln","Name":"","ParentKey":"kgmk8p5nrm9mb1zxsln","Syntax":"","Logic":"","Output":"\n\nNavigation:\nHome\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"navigation","ElementKey":"kgmk8p5nrm9mb1zxsln","Name":"","ParentKey":"follows_room","Syntax":"","Logic":"","Output":"","Tags":"look|enter_message","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"move","ElementKey":"motjz6aw1zdmb1zxsln","Name":"","ParentKey":"pjzh7nz5numb1zxsln","Syntax":"","Logic":"home","Output":"You return to the testing home room.","Tags":"[player]","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"input","ElementKey":"pjzh7nz5numb1zxsln","Name":"","ParentKey":"follows_room","Syntax":"(home)","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"action","ElementKey":"4t4m9spl24xmb1zxsln","Name":"","ParentKey":"ilnsz4q0i3kmb1zxsln","Syntax":"","Logic":"look","Output":"","Tags":"!_type|room","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"input","ElementKey":"ilnsz4q0i3kmb1zxsln","Name":"","ParentKey":"follows_room","Syntax":"[tplt_syntax]((look))","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},
  {"ElementType":"set","ElementKey":"evdhj8y5yb7mb1zxsln","Name":"","ParentKey":"il0qybr40vmb1zxsln","Syntax":"","Logic":"[trv_following_thief]active","Output":"true","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"message","ElementKey":"7jdyv4ndavcmb1zxsln","Name":"","ParentKey":"il0qybr40vmb1zxsln","Syntax":"","Logic":"","Output":"\nYou activate the thief's travel.\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"input","ElementKey":"il0qybr40vmb1zxsln","Name":"","ParentKey":"follows_room","Syntax":"[tplt_syntax]((greenbutton_push))","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"set","ElementKey":"l3gaecdeobnmb1zxslo","Name":"","ParentKey":"t1u41kf3vzmb1zxslo","Syntax":"","Logic":"[trv_following_thief]active","Output":"false","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"message","ElementKey":"gkrixyiupzpmb1zxslo","Name":"","ParentKey":"t1u41kf3vzmb1zxslo","Syntax":"","Logic":"","Output":"\nYou deactivate the thief's travel.\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"input","ElementKey":"t1u41kf3vzmb1zxslo","Name":"","ParentKey":"follows_room","Syntax":"[tplt_syntax]((redbutton_push))","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"room","ElementKey":"follows_room","Name":"NPC Follows the Player","ParentKey":"root","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"logic","ElementKey":"o5sb6k3naamb1zxslo","Name":"","ParentKey":"ofu3bb2iltmb1zxslo","Syntax":"","Logic":"[self]((nav))active = 'true'","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"enter_message","ElementKey":"ofu3bb2iltmb1zxslo","Name":"","ParentKey":"y1gqie2zhynmb1zxslo","Syntax":"","Logic":"","Output":"\nThe thief follows you.\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"message","ElementKey":"z7fmnkzb3thmb1zxslo","Name":"","ParentKey":"cyaq2kdptjomb1zxslo","Syntax":"","Logic":"","Output":"\nYou see a thief.\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"look","ElementKey":"cyaq2kdptjomb1zxslo","Name":"","ParentKey":"y1gqie2zhynmb1zxslo","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"logic","ElementKey":"f0vjxwlawo7mb1zxslo","Name":"","ParentKey":"b0lovzxzrkdmb1zxslo","Syntax":"","Logic":"[self]((nav))active = 'true'","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"message","ElementKey":"b0lovzxzrkdmb1zxslo","Name":"","ParentKey":"trv_following_thief","Syntax":"","Logic":"","Output":"\nThe thief follows you.\n","Tags":"!_enter","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"travel","ElementKey":"trv_following_thief","Name":"","ParentKey":"y1gqie2zhynmb1zxslo","Syntax":"","Logic":"[follow|player]","Output":"","Tags":"nav","Repeat":"","RepeatIndex":"0","Active":"false","Sort":1},{"ElementType":"npc","ElementKey":"y1gqie2zhynmb1zxslo","Name":"Following Thief","ParentKey":"follows_room","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"enter_message","ElementKey":"1ve21x213e5imb1zxslo","Name":"","ParentKey":"taking_room","Syntax":"","Logic":"","Output":"\nYou are in the taking and putting room.\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"message","ElementKey":"nboyuzk6fpcmb1zxslo","Name":"","ParentKey":"vjlc5zyxtsmb1zxslo","Syntax":"","Logic":"","Output":"\nYou look around...\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"look","ElementKey":"vjlc5zyxtsmb1zxslo","Name":"","ParentKey":"taking_room","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"message","ElementKey":"2ocm48ombc3mb1zxslo","Name":"","ParentKey":"td8qinrjz07mb1zxslo","Syntax":"","Logic":"","Output":"\n\nNavigation:\nHome\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"navigation","ElementKey":"td8qinrjz07mb1zxslo","Name":"","ParentKey":"taking_room","Syntax":"","Logic":"","Output":"","Tags":"look|enter_message","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},
  {"ElementType":"move","ElementKey":"5furgt1kmiemb1zxslo","Name":"","ParentKey":"tnwlefskmumb1zxslo","Syntax":"","Logic":"home","Output":"You return to the testing home room.","Tags":"[player]","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"input","ElementKey":"tnwlefskmumb1zxslo","Name":"","ParentKey":"taking_room","Syntax":"(home)","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"action","ElementKey":"mfa9ojdlleemb1zxslo","Name":"","ParentKey":"iuu1ym1rwvsmb1zxslo","Syntax":"","Logic":"look","Output":"","Tags":"!_type|room","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"input","ElementKey":"iuu1ym1rwvsmb1zxslo","Name":"","ParentKey":"taking_room","Syntax":"[tplt_syntax]((look))","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"room","ElementKey":"taking_room","Name":"The Taking and Putting Room","ParentKey":"root","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"enter_message","ElementKey":"8pg0x2vqm3mmb1zxslo","Name":"","ParentKey":"4cnn71h36npmb1zxslo","Syntax":"","Logic":"","Output":"\nYou see a key.\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"message","ElementKey":"weordl2i8gmb1zxslo","Name":"","ParentKey":"4jtf9bn3btbmb1zxslo","Syntax":"","Logic":"","Output":"\n\nYou see a key.","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"logic","ElementKey":"5da2ap6vrgqmb1zxslo","Name":"","ParentKey":"4jtf9bn3btbmb1zxslo","Syntax":"","Logic":"?[self]parent = [room]","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"look","ElementKey":"4jtf9bn3btbmb1zxslo","Name":"","ParentKey":"4cnn71h36npmb1zxslo","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"move","ElementKey":"dxmc5q1nuclmb1zxslo","Name":"","ParentKey":"w49h65sg8hlmb1zxslo","Syntax":"","Logic":"[player]","Output":"\nYou take the key.","Tags":"[self]","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"set","ElementKey":"0y3t5kpebanmmb1zxslo","Name":"","ParentKey":"w49h65sg8hlmb1zxslo","Syntax":"","Logic":"[self]tags","Output":"\n+inventory","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"input","ElementKey":"w49h65sg8hlmb1zxslo","Name":"","ParentKey":"4cnn71h36npmb1zxslo","Syntax":"[tplt_syntax]((key_take))","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"object","ElementKey":"4cnn71h36npmb1zxslo","Name":"Key","ParentKey":"taking_room","Syntax":"[tplt_syntax]((key_id))","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":1},{"ElementType":"enter_message","ElementKey":"pqtrpne8n6mb1zxslo","Name":"","ParentKey":"0z9bm771n8nrmb1zxslo","Syntax":"","Logic":"","Output":"\nYou see a box.\n","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":2},{"ElementType":"message","ElementKey":"jmtt4cv2qipmb1zxslo","Name":"","ParentKey":"lq2i09bwjdamb1zxslo","Syntax":"","Logic":"","Output":"\n\nYou see a box.","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":2},{"ElementType":"logic","ElementKey":"ot59nvzsixmb1zxslo","Name":"","ParentKey":"lq2i09bwjdamb1zxslo","Syntax":"","Logic":"?[self]parent = [room]","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":2},{"ElementType":"look","ElementKey":"lq2i09bwjdamb1zxslo","Name":"","ParentKey":"0z9bm771n8nrmb1zxslo","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":2},{"ElementType":"action","ElementKey":"0aumlyhw8d8gmb1zxslo","Name":"","ParentKey":"1rcv9637b69mb1zxslo","Syntax":"","Logic":"look","Output":"\nYou examine the box.\n","Tags":"!_type|children","Repeat":"","RepeatIndex":"0","Active":"true","Sort":2},{"ElementType":"examine_box","ElementKey":"1rcv9637b69mb1zxslo","Name":"","ParentKey":"0z9bm771n8nrmb1zxslo","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":2},{"ElementType":"move","ElementKey":"5wrrlo4ddw2mb1zxslo","Name":"","ParentKey":"uhxpnhdx7rhmb1zxslo","Syntax":"","Logic":"[self]","Output":"\nYou put the [target] in the box.\n","Tags":"[syntax]","Repeat":"","RepeatIndex":"0","Active":"true","Sort":2},
  {"ElementType":"input","ElementKey":"uhxpnhdx7rhmb1zxslo","Name":"","ParentKey":"0z9bm771n8nrmb1zxslo","Syntax":"[tplt_syntax]((box_put))","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":2},{"ElementType":"action","ElementKey":"9b9mp08om9cmb1zxslo","Name":"","ParentKey":"grv06oghtg8mb1zxslo","Syntax":"","Logic":"examine_box","Output":"","Tags":"!_type|self","Repeat":"","RepeatIndex":"0","Active":"true","Sort":2},{"ElementType":"input","ElementKey":"grv06oghtg8mb1zxslo","Name":"","ParentKey":"0z9bm771n8nrmb1zxslo","Syntax":"[tplt_syntax]((box_examine))","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":2},{"ElementType":"object","ElementKey":"0z9bm771n8nrmb1zxslo","Name":"Box","ParentKey":"taking_room","Syntax":"","Logic":"","Output":"","Tags":"","Repeat":"","RepeatIndex":"0","Active":"true","Sort":2}
];

        // Regex Library
        const regexLib = [
            { "Description": "Look", "Regex": "(look(?: around)?|l)", "Test": "look" },
            { "Description": "Take X ITEM", "Regex": "^(take|pick up)\\s+(the\\s+)?ITEM", "Test": "take item" },
            { "Description": "Drop ITEM", "Regex": "^(drop|put down)\\s+(the\\s+)?ITEM", "Test": "drop item" },
            { "Description": "Put In ITEM", "Regex": "put.*in.*ITEM", "Test": "put the key in the item" },
            { "Description": "Attack FOE", "Regex": "(attack.*FOE|!.*FOE)", "Test": "!foe" },
            { "Description": "Push Button", "Regex": "^(push|press)( the)? button$", "Test": "press the button" },
            { "Description": "Push X Button", "Regex": "^(push|press)( the)?( X)? button$", "Test": "press the X button" }
        ];


        let currentParent = null;
        let newElementParentKey = "";
        let expandedNodes = new Set();

        // !@! icons
        // Icons
            const icoGame = `<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg width="16" height="16" viewBox="0 0 4.2333332 4.2333333" version="1.1" id="svg5" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"> <defs id="defs2" /> <g aria-label="G" id="text8654" style="font-weight:bold;font-size:3.8988px;font-family:'ITC Bauhaus';-inkscape-font-specification:'ITC Bauhaus Bold';fill:none;stroke:#8e8e8e;stroke-width:0.0142143;stroke-linejoin:bevel;paint-order:stroke fill markers"> <path d="m 2.2882142,3.5085379 c 0.4054751,0 0.7563671,-0.1208628 1.0448783,-0.3586896 V 1.9490179 H 2.1790478 v 0.428868 h 0.6666947 v 0.5770224 c -0.136458,0.070178 -0.3041063,0.1130652 -0.4912487,0.1130652 -0.565326,0 -0.9279144,-0.3781836 -0.9279144,-0.9824976 0,-0.58482 0.3391956,-0.9162179 0.9396108,-0.9162179 0.2378268,0 0.5146415,0.050684 0.7251767,0.1247616 L 3.2317237,0.90024076 C 2.9977957,0.78717557 2.7014869,0.72479477 2.3973806,0.72479477 c -0.9084204,0 -1.4971392,0.56922483 -1.4971392,1.41916313 0,0.818748 0.5536296,1.36458 1.3879728,1.36458 z" style="font-family:System-ui;-inkscape-font-specification:'System-ui Bold';fill:#ffffff;stroke:none" id="path9293" /> </g> </svg>`;
            const icoPlayer = `<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg width="16" height="16" viewBox="0 0 4.2333332 4.2333333" version="1.1" id="svg5" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"> <defs id="defs2" /> <g id="layer1" style="fill:#ffffff;fill-opacity:1;stroke:none" transform="matrix(0.74013018,0,0,0.74013018,0.55005776,0.55005778)"> <g aria-label="G" id="text147" style="font-weight:bold;font-size:5.4836px;font-family:'DejaVu Sans';-inkscape-font-specification:'DejaVu Sans Bold';fill:#ffffff;fill-opacity:1;stroke:none;stroke-width:0.931837;stroke-linecap:round;stroke-linejoin:round"> <path id="path1202" style="fill:#ffffff;fill-opacity:1;stroke:none;stroke-width:0.245993;stroke-linecap:round;stroke-linejoin:miter;stroke-dasharray:none;stroke-opacity:1;paint-order:stroke fill markers" d="M 2.1154655,0.29958256 A 0.95769183,0.95769183 0 0 0 1.157917,1.2576116 0.95769183,0.95769183 0 0 0 1.5470861,2.0268214 C 1.0473631,2.1507604 0.63085688,2.4696209 0.63085688,3.1299481 V 3.9337508 H 3.6024763 V 3.1299481 c 0,-0.6590471 -0.4175177,-0.9788423 -0.9176706,-1.1031267 A 0.95769183,0.95769183 0 0 0 3.0734944,1.2576116 0.95769183,0.95769183 0 0 0 2.1154655,0.29958256 Z" /> </g> </g> </svg>`;
            const icoRoom = `<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg width="16" height="16" viewBox="0 0 4.2333332 4.2333333" version="1.1" id="svg5" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"> <defs id="defs2" /> <path id="path3110" style="fill:#ffffff;fill-opacity:1;stroke:none;stroke-width:0.128568;stroke-linecap:round;stroke-linejoin:miter;stroke-dasharray:none;stroke-opacity:1;paint-order:stroke fill markers" d="M 2.1166666,0.6755942 1.3764382,1.2733867 0.63620985,1.8711792 H 1.094196 V 3.4357827 H 3.1391372 V 1.8711792 H 3.5971234 L 2.856895,1.2733867 Z" /> <rect style="fill:#9c9c9c;fill-opacity:1;stroke:none;stroke-width:0.150738;stroke-linejoin:bevel;paint-order:stroke fill markers" id="rect12310" width="0.49860835" height="0.72685415" x="2.2512157" y="2.7089283" /> <rect style="fill:#9c9c9c;fill-opacity:1;stroke:none;stroke-width:0.185208;stroke-linejoin:bevel;paint-order:stroke fill markers" id="rect13248" width="0.47124618" height="0.46280029" x="1.540359" y="1.9300244" /> </svg>`;
            const icoAttrib = `<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg width="16" height="16" viewBox="0 0 4.2333332 4.2333333" version="1.1" id="svg5" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"> <defs id="defs2" /> <text xml:space="preserve" style="font-weight:bold;font-size:3.45983px;font-family:System-ui;-inkscape-font-specification:'System-ui Bold';fill:#ffffff;stroke-width:0.0126139;stroke-linejoin:bevel;paint-order:stroke fill markers" x="1.644399" y="3.3846965" id="text21025"><tspan id="tspan21023" style="stroke-width:0.0126139" x="1.644399" y="3.3846965">i</tspan></text> </svg>`;
            const icoOther = `<svg width="16" height="16" viewBox="0 0 4.2333332 4.2333333" xmlns="http://www.w3.org/2000/svg"><path style="fill:none;stroke:#ffffff;stroke-width:0.264583;stroke-linecap:round;stroke-linejoin:miter;stroke-dasharray:none;stroke-opacity:1;" d="M 0.69371456,2.1166666 H 3.5396187"/></svg>`;
            const icoObject = `<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg width="16" height="16" viewBox="0 0 4.2333332 4.2333333" version="1.1" id="svg5" sodipodi:docname="object_ico.svg" inkscape:version="1.2.2 (b0a8486, 2022-12-01)" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"> <sodipodi:namedview id="namedview38" pagecolor="#505050" bordercolor="#eeeeee" borderopacity="1" inkscape:showpageshadow="0" inkscape:pageopacity="0" inkscape:pagecheckerboard="0" inkscape:deskcolor="#505050" showgrid="false" inkscape:zoom="42.382213" inkscape:cx="4.1408881" inkscape:cy="8.0104359" inkscape:window-width="1916" inkscape:window-height="1074" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="1" inkscape:current-layer="svg5" showguides="true"> <sodipodi:guide position="2.1166666,4.4412308" orientation="16.206024,0" id="guide328" inkscape:locked="false" /> <sodipodi:guide position="2.3785036,2.3187412" orientation="0,-1" id="guide334" inkscape:locked="false" /> <sodipodi:guide position="2.9715688,0.78298396" orientation="0,-1" id="guide336" inkscape:locked="false" /> <sodipodi:guide position="0.69898409,1.7050026" orientation="1,0" id="guide338" inkscape:locked="false" /> <sodipodi:guide position="3.5343492,2.7683155" orientation="1,0" id="guide340" inkscape:locked="false" /> <sodipodi:guide position="3.5343493,2.9508443" orientation="0,-1" id="guide352" inkscape:locked="false" /> <sodipodi:guide position="3.5343492,1.4150872" orientation="0,-1" id="guide354" inkscape:locked="false" /> <sodipodi:guide position="2.4534171,3.5829476" orientation="0,-1" id="guide1047" inkscape:locked="false" /> </sodipodi:namedview> <defs id="defs2" /> <path style="fill:#ffffff;stroke:none;stroke-width:0.185208;stroke-linecap:round;stroke-dasharray:none;paint-order:stroke fill markers;fill-opacity:1" d="M 2.1166666,0.65038564 3.5343491,1.282489 v 1.5357571 l -1.4176825,0.63832 -1.4176825,-0.63832 V 1.282489 Z" id="path1063" /> <path style="fill:#ffffff;stroke:none;stroke-width:0.185208;stroke-linecap:round;stroke-dasharray:none;paint-order:stroke fill markers;fill-opacity:1" d="M 2.1166666,0.65038564 3.5343491,1.282489 v 1.5357571 l -1.4176825,0.63832 -1.4176825,-0.63832 V 1.282489 Z" id="path2373" /> <path style="fill:none;fill-opacity:1;stroke:#8e8e8e;stroke-width:0.18520833;stroke-linecap:butt;stroke-dasharray:none;stroke-opacity:1;paint-order:stroke fill markers;stroke-linejoin:bevel" d="M 0.6989841,1.282489 2.1166666,1.9145921 3.5343491,1.282489" id="path5018" /> <path style="fill:none;fill-opacity:1;stroke:#8e8e8e;stroke-width:0.185208;stroke-linecap:butt;stroke-linejoin:bevel;stroke-dasharray:none;stroke-opacity:1;paint-order:stroke fill markers" d="M 2.1166666,1.9145921 V 3.4503492" id="path6370" /> </svg>`;
            const icoMessage = `<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg width="16" height="16" viewBox="0 0 4.2333332 4.2333333" version="1.1" id="svg5" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"> <defs id="defs2" /> <rect style="fill:#ffffff;fill-opacity:1;stroke:none;stroke-width:0.165345;stroke-linejoin:bevel;paint-order:stroke fill markers" id="rect15482" width="1.9418752" height="2.6706309" x="1.1457291" y="0.78135115" /> <path style="fill:none;fill-opacity:1;stroke:#939393;stroke-width:0.185208;stroke-linejoin:bevel;stroke-opacity:1;paint-order:stroke fill markers" d="M 1.5488185,1.5004032 H 2.6845148" id="path15542" /> <path style="fill:none;fill-opacity:1;stroke:#939393;stroke-width:0.185208;stroke-linejoin:bevel;stroke-opacity:1;paint-order:stroke fill markers" d="M 1.5488185,2.1166666 H 2.6845148" id="path16407" /> </svg>`;
            const icoMove = `<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg width="16" height="16" viewBox="0 0 4.2333332 4.2333333" version="1.1" id="svg5" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"> <defs id="defs2" /> <path style="fill:#ffffff;fill-opacity:1;stroke:none;stroke-width:0.185208;stroke-linejoin:bevel;stroke-opacity:1;paint-order:stroke fill markers" id="path16515" d="m 2.8393816,2.1992004 -1.0961629,0.6328699 -1.09616284,0.6328699 0,-1.2657398 0,-1.26573985 1.09616294,0.63286995 z" transform="translate(0.37344791,-0.08253377)" /> </svg>`;
            const icoAttack = `<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg width="16" height="16" viewBox="0 0 4.2333332 4.2333333" version="1.1" id="svg5" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"> <defs id="defs2" /> <g id="g17152" transform="rotate(45,2.1018541,2.1105311)"> <rect style="fill:#ffffff;fill-opacity:1;stroke:none;stroke-width:0.198799;stroke-linejoin:bevel;stroke-opacity:1;paint-order:stroke fill markers" id="rect17051" width="0.73135507" height="2.6537266" x="1.7509891" y="0.90471673" /> <path style="fill:#ffffff;fill-opacity:1;stroke:none;stroke-width:0.185208;stroke-linejoin:bevel;stroke-opacity:1;paint-order:stroke fill markers" id="path17125" d="m 2.1166666,0.3620086 0.1814879,0.31434643 0.181488,0.31434643 -0.3629759,-1e-8 -0.362976,-10e-9 0.181488,-0.31434641 z" transform="translate(7.521059e-8,-0.07733837)" /> <rect style="fill:#ffffff;fill-opacity:1;stroke:none;stroke-width:0.185208;stroke-linejoin:bevel;stroke-opacity:1;paint-order:stroke fill markers" id="rect17127" width="2.029305" height="0.49957958" x="1.1020142" y="2.3346605" /> </g> </svg>`;
            const icoGlobal = `<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg width="16" height="16" viewBox="0 0 4.2333332 4.2333333" version="1.1" id="svg5" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"> <defs id="defs2" /> <circle style="fill:#ffffff;fill-opacity:1;stroke:none;stroke-width:0.185208;stroke-linejoin:bevel;stroke-opacity:1;paint-order:stroke fill markers" id="path17273" cx="2.1166666" cy="2.1166666" r="1.3248924" /> <path style="fill:none;fill-opacity:1;stroke:#8e8e8e;stroke-width:0.19686;stroke-linejoin:bevel;stroke-opacity:1;paint-order:stroke fill markers" d="M 1.1448412,2.1166666 H 3.0884921" id="path17275" /> </svg>`;
            const icoAction = `<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg width="16" height="16" viewBox="0 0 4.2333332 4.2333333" version="1.1" id="svg5" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"> <defs id="defs2" /> <g aria-label="!" id="text18965" style="font-weight:bold;font-size:4.37606px;font-family:System-ui;-inkscape-font-specification:'System-ui Bold';fill:#ffffff;stroke-width:0.0159544;stroke-linejoin:bevel;paint-order:stroke fill markers"> <path d="m 1.9000508,2.5849076 h 0.437606 L 2.3989217,0.57629608 H 1.838786 Z m 0.214427,1.0721347 c 0.223179,0 0.3763411,-0.1619142 0.3763411,-0.3719651 0,-0.223179 -0.1531621,-0.3850933 -0.3763411,-0.3850933 -0.2231791,0 -0.3719651,0.1619143 -0.3719651,0.3850933 0,0.2100509 0.148786,0.3719651 0.3719651,0.3719651 z" id="path19468" /> </g> </svg>`;
            const icoInput = `<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg width="16" height="16" viewBox="0 0 4.2333332 4.2333333" version="1.1" id="svg5" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"> <defs id="defs2" /> <path style="fill:#ffffff;fill-opacity:1;stroke:none;stroke-width:0.185208;stroke-linejoin:bevel;paint-order:stroke fill markers" id="path19523" d="m 1.275162,2.0133541 -0.7057629,0.4074724 -0.70576287,0.4074724 3e-8,-0.8149449 -3e-8,-0.8149447 0.70576291,0.4074724 z" transform="translate(0.61360234,0.10331256)" /> <path style="fill:none;fill-opacity:1;stroke:#ffffff;stroke-width:0.185208;stroke-linejoin:bevel;paint-order:stroke fill markers;stroke-opacity:1" d="M 1.952999,2.9316113 H 3.5563688" id="path19525" /> </svg>`;
            const icoLogic = `<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg width="16" height="16" viewBox="0 0 4.2333332 4.2333333" version="1.1" id="svg5" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"> <defs id="defs2" /> <g aria-label="?" id="text20223" style="font-weight:bold;font-size:3.75627px;font-family:System-ui;-inkscape-font-specification:'System-ui Bold';fill:#ffffff;stroke-width:0.0136947;stroke-linejoin:bevel;paint-order:stroke fill markers"> <path d="m 1.8931671,2.5486401 h 0.47329 V 2.3983893 c 0,-0.3042579 0.5446591,-0.4432398 0.5446591,-0.9766302 0,-0.4019209 -0.3080141,-0.6460784 -0.8151106,-0.6460784 -0.2629389,0 -0.5409028,0.0676129 -0.7737916,0.18405722 L 1.4349021,1.3240961 c 0.180301,-0.086394 0.3606019,-0.1277132 0.5371466,-0.1277132 0.277964,0 0.4394836,0.1089319 0.4394836,0.2892328 0,0.319283 -0.5183652,0.47329 -0.5183652,0.9127736 z m 0.236645,0.9090173 c 0.1878135,0 0.3192829,-0.1352257 0.3192829,-0.3192829 0,-0.1953261 -0.1277132,-0.3305518 -0.3192829,-0.3305518 -0.1915698,0 -0.3230392,0.1352257 -0.3230392,0.3305518 0,0.1840572 0.1352257,0.3192829 0.3230392,0.3192829 z" id="path20755" /> </g> </svg>`;
            const icoInject = `<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg width="16" height="16" viewBox="0 0 4.2333332 4.2333333" version="1.1" id="svg5" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"> <defs id="defs2" /> <path style="fill:none;fill-opacity:1;stroke:#ffffff;stroke-width:0.185208;stroke-linejoin:bevel;paint-order:stroke fill markers;stroke-opacity:1" d="M 1.952999,2.9316113 H 3.5563688" id="path19525" /> <text xml:space="preserve" style="font-weight:bold;font-size:3.24209px;font-family:System-ui;-inkscape-font-specification:'System-ui Bold';fill:#ffffff;fill-opacity:1;stroke:none;stroke-width:0.0118201;stroke-linejoin:bevel;stroke-opacity:1;paint-order:stroke fill markers" x="0.22496246" y="3.1849368" id="text20814"><tspan id="tspan20812" style="stroke-width:0.0118201" x="0.22496246" y="3.1849368">+</tspan></text> </svg>`;
            const icoSet = `<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg width="16" height="16" viewBox="0 0 4.2333332 4.2333333" version="1.1" id="svg5" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"> <defs id="defs2" /> <path style="fill:#ffffff;fill-opacity:1;stroke:none;stroke-width:0.185208;stroke-linejoin:bevel;paint-order:stroke fill markers" id="path19523" d="m 1.275162,2.0133541 -0.7057629,0.4074724 -0.70576287,0.4074724 3e-8,-0.8149449 -3e-8,-0.8149447 0.70576291,0.4074724 z" transform="translate(0.61360234,0.10331256)" /> <rect style="fill:#ffffff;stroke-width:0.185208;stroke-linejoin:bevel;paint-order:stroke fill markers" id="rect20904" width="1.4300268" height="1.9852276" x="2.4454238" y="1.1240529" /> </svg>`;
            const icoNav = `<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg width="16" height="16" viewBox="0 0 4.2333332 4.2333333" version="1.1" id="svg5" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"> <defs id="defs2" /> <path style="fill:#ffffff;fill-opacity:1;stroke:none;stroke-width:0.185208;stroke-linejoin:bevel;stroke-opacity:1;paint-order:stroke fill markers" id="path1135" d="m 2.1166666,-0.50851178 0.3327753,0.5763839 0.3327754,0.57638386 -0.6655507,-7e-8 -0.6655508,4e-8 0.3327754,-0.57638383 z" transform="matrix(0.84700546,0,0,0.84700546,0.32383842,0.7832153)" /> <path style="fill:#ffffff;fill-opacity:1;stroke:none;stroke-width:0.185208;stroke-linejoin:bevel;stroke-opacity:1;paint-order:stroke fill markers" id="path1617" d="m 2.1166666,-0.50851178 0.3327753,0.5763839 0.3327754,0.57638386 -0.6655507,-7e-8 -0.6655508,4e-8 0.3327754,-0.57638383 z" transform="matrix(0,0.84700546,-0.84700546,0,3.464608,0.33165152)" /> <path style="fill:#ffffff;fill-opacity:1;stroke:none;stroke-width:0.185208;stroke-linejoin:bevel;stroke-opacity:1;paint-order:stroke fill markers" id="path1619" d="m 2.1166666,-0.50851178 0.3327753,0.5763839 0.3327754,0.57638386 -0.6655507,-7e-8 -0.6655508,4e-8 0.3327754,-0.57638383 z" transform="matrix(-0.84700546,0,0,-0.84700546,3.9016279,3.460076)" /> <path style="fill:#ffffff;fill-opacity:1;stroke:none;stroke-width:0.185208;stroke-linejoin:bevel;stroke-opacity:1;paint-order:stroke fill markers" id="path1621" d="m 2.1166666,-0.50851178 0.3327753,0.5763839 0.3327754,0.57638386 -0.6655507,-7e-8 -0.6655508,4e-8 0.3327754,-0.57638383 z" transform="matrix(0,-0.84700546,0.84700546,0,0.76085834,3.9116397)" /> </svg>`;

            const icoTreeExp = `<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg width="24" height="16" viewBox="0 0 6.3500001 4.2333332" version="1.1" id="svg5" inkscape:version="1.2.2 (b0a8486, 2022-12-01)" sodipodi:docname="tree_exp.svg" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"> <sodipodi:namedview id="namedview7" pagecolor="#505050" bordercolor="#eeeeee" borderopacity="1" inkscape:showpageshadow="0" inkscape:pageopacity="0" inkscape:pagecheckerboard="0" inkscape:deskcolor="#505050" inkscape:document-units="px" showgrid="false" inkscape:zoom="42.117048" inkscape:cx="12.441518" inkscape:cy="8.0371255" inkscape:window-width="1916" inkscape:window-height="1068" inkscape:window-x="0" inkscape:window-y="4" inkscape:window-maximized="1" inkscape:current-layer="layer1" /> <defs id="defs2" /> <g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1"> <g id="g120" transform="matrix(0.54946881,0,0,0.54946881,0.08585497,0.9533879)"> <rect style="fill:none;fill-opacity:1;stroke:#ffffff;stroke-width:0.240763;stroke-linejoin:miter;stroke-dasharray:none;stroke-opacity:1;paint-order:stroke fill markers" id="rect2158" width="3.8522053" height="3.8522053" x="0.19056387" y="0.19056387" /> <path style="fill:none;fill-opacity:1;stroke:#ffffff;stroke-width:0.264583;stroke-linejoin:miter;stroke-dasharray:none;stroke-opacity:1;paint-order:stroke fill markers" d="M 2.1166665,0.7394208 V 3.4939122" id="path3687" /> <path style="fill:none;fill-opacity:1;stroke:#ffffff;stroke-width:0.264583;stroke-linejoin:miter;stroke-dasharray:none;stroke-opacity:1;paint-order:stroke fill markers" d="M 3.4939122,2.1166665 H 0.7394208" id="path3689" /> </g> </g> </svg>`;
            const icoTreeCol = `<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg width="24" height="16" viewBox="0 0 6.3500001 4.2333332" version="1.1" id="svg5" inkscape:version="1.2.2 (b0a8486, 2022-12-01)" sodipodi:docname="tree_col.svg" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"> <sodipodi:namedview id="namedview7" pagecolor="#505050" bordercolor="#eeeeee" borderopacity="1" inkscape:showpageshadow="0" inkscape:pageopacity="0" inkscape:pagecheckerboard="0" inkscape:deskcolor="#505050" inkscape:document-units="px" showgrid="false" inkscape:zoom="42.117048" inkscape:cx="12.417774" inkscape:cy="8.0371255" inkscape:window-width="1916" inkscape:window-height="1068" inkscape:window-x="0" inkscape:window-y="4" inkscape:window-maximized="1" inkscape:current-layer="layer1" /> <defs id="defs2" /> <g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1"> <g id="g248" transform="matrix(0.54945826,0,0,0.54945826,0.08585698,0.95364662)"> <rect style="fill:none;fill-opacity:1;stroke:#ffffff;stroke-width:0.240763;stroke-linejoin:miter;stroke-dasharray:none;stroke-opacity:1;paint-order:stroke fill markers" id="rect2158" width="3.8522053" height="3.8522053" x="0.19056387" y="0.19056387" /> <path style="fill:none;fill-opacity:1;stroke:#ffffff;stroke-width:0.264583;stroke-linejoin:miter;stroke-dasharray:none;stroke-opacity:1;paint-order:stroke fill markers" d="M 3.4939122,2.1166665 H 0.7394208" id="path3689" /> </g> </g> </svg>`;
            const icoFolder = `<?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg width="16" height="16" viewBox="0 0 4.2333332 4.2333333" version="1.1" id="svg138" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"> <defs id="defs135" /> <g id="layer1"> <path id="rect233" style="fill:#ffffff;stroke:none;stroke-width:0.264583;paint-order:stroke fill markers;fill-opacity:1" d="M 0.26458333 0.52916667 L 0.26458333 1.0583333 L 0.26458333 1.3229167 L 0.26458333 3.7041667 L 3.96875 3.7041667 L 3.96875 1.0583333 L 2.38125 1.0583333 L 2.38125 1.3229167 L 3.7041667 1.3229167 L 3.7041667 3.4395833 L 0.52916667 3.4395833 L 0.52916667 1.4226522 L 0.52916667 1.3229167 L 0.52916667 1.0583333 L 0.52916667 0.79375 L 2.1166667 0.79375 L 2.1166667 0.52916667 L 0.26458333 0.52916667 z M 2.1166667 0.79375 L 2.1166667 1.0583333 L 2.38125 1.0583333 L 2.38125 0.79375 L 2.1166667 0.79375 z " /> </g> </svg>`;

        // Global Vars
            const adminInput = document.getElementById("admin-input");
            const adminInterface = document.getElementById("admin-interface");
            const adminInputContainer = document.getElementById("admin-input-container");
            const treeview = document.getElementById("treeview");
            const resizer = document.getElementById('resizer');
            const details = document.getElementById("details");
            const editorContainer = document.getElementById("editor-container");
            const elemLimit = 20; // Number of elements per line in the db
            const elementTypes = [
                "action", "attack", "attribute", "custom", "dev_note", "enter_message", "flee", "global", "injection",
                "input", "link", "logic", "macro", "message", "move", "navigation", "nothing", "npc", "object",
                "room", "round", "rule", "ruleset", "set", "travel", "folder"
            ];



        // Treeview Resizing
        let isResizing = false;

        resizer.addEventListener('mousedown', (e) => {
            isResizing = true;
            document.body.style.cursor = 'ew-resize';
        });

        document.addEventListener('mousemove', (e) => {
            if (!isResizing) return;

            const offsetRight = adminInterface.clientWidth - (e.clientX - adminInterface.offsetLeft);
            const newTreeviewWidth = e.clientX - adminInterface.offsetLeft;

            if (newTreeviewWidth > 100 && newTreeviewWidth < 500) {
                treeview.style.width = `${newTreeviewWidth}px`;
            }
        });

        document.addEventListener('mouseup', () => {
            isResizing = false;
            document.body.style.cursor = 'default';
        });




        function createNewElement(elementKey, elementType, name, doLogging, doShowDetails)
        {
            if (elementKey == "")
            {
                elementKey = getGuid();
            }

            let entry = {
                ElementType: elementType,
                ElementKey: elementKey,
                Name: name,
                ParentKey: currentParent,
                Syntax: "",
                Logic: "",
                Output: "",
                Tags: "",
                Repeat: "",
                RepeatIndex: "0",
                Template: "",
                Active: "true",
                Sort: ""
            };

            database.push(entry);

            if (entry.ParentKey) {
                newElementParentKey = entry.ParentKey;
            }

            if (doShowDetails)
            {
                showDetails(entry);
            }

            buildTreeView(true);

            if (doLogging == true)
            {
                logAdminMessage("Added: " + entry.Name);
            }
        }

        function setParent(newParent)
        {
            let elem = database.filter(item => item.ElementKey === currentParent)[0];

            elem.ParentKey = newParent;

            showDetails(elem);

            buildTreeView(true);
        }

        function createNewFullElement(
            elementType,
            elementKey,
            name,
            parentKey,
            syntax,
            logic,
            output,
            tags,
            repeat,
            sort
        )
        {
            if (elementKey == "")
            {
                elementKey = getGuid();
            }

            let entry = {
                ElementType: elementType,
                ElementKey: elementKey,
                Name: name,
                ParentKey: parentKey,
                Syntax: syntax,
                Logic: logic,
                Output: output,
                Tags: tags,
                Repeat: repeat,
                RepeatIndex: "0",
                Template: "",
                Active: "true",
                Sort: sort
            };

            database.push(entry);
        }

        function updateElementType(item, newType)
        {
            item.ElementType = newType;
            showDetails(item);
        }


        function logAdminMessage(message)
        {
            details.innerHTML = message + "<br>";
            details.scrollTop = details.scrollHeight;
        }

        function getGuid()
        {
            return Math.random().toString(36).substring(2) + (new Date()).getTime().toString(36);
        }

        function processInput(command)
        {
            if (command === "!_admin") {
                enterAdminMode();
                return;
            }
        }

        function processAdminInput(command)
        {
            if (command.startsWith("add "))
            {
                createNewElement("", "", command.substring(4), true, true);
                return;
            }
            if (command.startsWith("parent "))
            {
                setParent(command.substring(7));
                return;
            }

            switch (command)
            {
                case "exit":
                    exitAdminMode();
                    break;
                case "database":
                case "db":
                    openDatabaseModal();
                    break;
                case "regexlib":
                    regexLibPrint();
                    break;
                case "regex":
                    regexLibTest();
                    break;
                case "save":
                    saveFile();
                    break;
                default:
                    logMessage("Unknown command: " + command);
                    break;
            }
        }

        // !@! [saving save file savefile]
        function saveFile()
        {
            let htmlDoc = document.documentElement.cloneNode(true);

            // Make sure the latest database is stored
            let latestDatabase = JSON.parse(JSON.stringify(database)); // Deep clone to ensure correctness

            // Build compact JSON with newlines every elemLimit items
            let lines = [];
            for (let i = 0; i < latestDatabase.length; i += elemLimit) {
                let chunk = latestDatabase.slice(i, i + elemLimit);
                lines.push(JSON.stringify(chunk).slice(1, -1)); // Strip [ and ]
            }
            let formattedDatabase = `[\n  ${lines.join(",\n  ")}\n]`;

            // Ensure correct replacement of the old database
            let htmlContent = "<!DOCTYPE html>" + htmlDoc.outerHTML;
            htmlContent = htmlContent.replace(/let database = \[([\s\S]*?)\];/, `let database = ${formattedDatabase};`);

            let blob = new Blob([htmlContent], { type: "text/html" });
            let a = document.createElement("a");
            a.href = URL.createObjectURL(blob);
            a.download = "worldweaver.html";
            a.click();
        }

        function enterAdminMode()
        {
            adminInterface.style.display = "flex";  // Show admin interface
            adminInputContainer.style.display = "flex";  // Show admin input field
            buildTreeView(true);
            adminInput.focus();  // Focus the admin input field
        }

        // REGEX Testing
        function regexCheck(regexString, inputString)
        {
            if (regexString === "" || inputString === "")
            {
                return false;
            }
            let pattern = new RegExp(regexString, 'i');
            if (pattern.test(inputString))
            {
                return true;
            }
            return false;
        }
        function regexLibTest()
        {
            details.innerHTML = "Regex Library Tests:<br /><br />";
            let row = "";

            for (rgx of regexLib)
            {
                row = `Regex: ${rgx.Regex} = `;
                if (regexCheck(rgx.Regex, rgx.Test))
                {
                    row += "<span style='color: #00ff00;'>[PASSED]</span>";
                }
                else
                {
                    row += "<span style='color: #ff5500;'>[FAILED]</span>";
                }
                row += "<br />";
                details.innerHTML += row;
            }
        }
        function regexLibPrint()
        {
            details.innerHTML = "";
            let rows = "Regex Library :<br /><br /><table style='border: none;'>";

            for (rgx of regexLib)
            {
                rows += "<tr>";
                rows += `<td style="padding: 3px; border: none; padding-right: 20px;">${rgx.Description}</td>`;
                rows += `<td style="padding: 3px; border: none; padding-right: 20px;"><strong>${rgx.Regex}</strong></td>`;
                rows += `<td style="padding: 3px; border: none; padding-right: 20px;">${rgx.Test}</td>`;
                rows += "</tr>"
            }

            rows += "</table>";
            details.innerHTML = rows;
        }

        function buildTreeView(restoreExpansion)
        {
            // Save the currently expanded nodes
            expandedNodes.clear();

            if (restoreExpansion)
            {
                document.querySelectorAll("#treeview ul").forEach(ul => {
                    if (ul.style.display === "block") {
                        let parentLi = ul.closest("li");
                        if (parentLi && parentLi.dataset.key) {
                            expandedNodes.add(parentLi.dataset.key);
                        }
                    }
                });
            }

            if (newElementParentKey) {
                expandedNodes.add(newElementParentKey);
                newElementParentKey = "";
            }

            treeview.innerHTML = '<div style="padding: 5px; font-family: monospace;"><span id="close-all-tree" class="link" style="cursor: pointer; color: lightblue;">Close All</span></div>';
            let rootItems = database.filter(item => item.ParentKey === null);
            let ul = document.createElement("ul");
            rootItems.forEach(item => ul.appendChild(createTreeNode(item)));
            treeview.appendChild(ul);


            document.getElementById("close-all-tree").addEventListener("click", () => {
                buildTreeView(false);
            });
        }

        function createTreeNode(item)
        {
            let li = document.createElement("li");
            li.dataset.key = item.ElementKey; // Store the ElementKey as a dataset

            let container = document.createElement("div");
            container.style.display = "flex";
            container.style.alignItems = "center";
            container.style.gap = "0.4em";

            // Toggle marker
            let toggleSpan = document.createElement("span");
            toggleSpan.classList.add("tree-toggle");
            toggleSpan.textContent = ""; // placeholder — only populated if children exist

            // Main label (icon + name)
            let span = document.createElement("span");
            span.style.cursor = "pointer";

            // Determine which icon to use
            let iconHTML = "";
            switch (item.ElementType)
            {
                case "game": iconHTML = icoGame; break;
                case "player":
                case "npc": iconHTML = icoPlayer; break;
                case "room": iconHTML = icoRoom; break;
                case "object": iconHTML = icoObject; break;
                case "message":
                case "dev_note":
                case "enter_message": iconHTML = icoMessage; break;
                case "folder": iconHTML = icoFolder; break;
                case "action": iconHTML = icoAction; break;
                case "macro":
                case "move":
                case "travel": iconHTML = icoMove; break;
                case "attack": iconHTML = icoAttack; break;
                case "global": iconHTML = icoGlobal; break;
                case "input": iconHTML = icoInput; break;
                case "logic": iconHTML = icoLogic; break;
                case "injection":
                case "link": iconHTML = icoInject; break;
                case "set": iconHTML = icoSet; break;
                case "navigation": iconHTML = icoNav; break;
                case "attribute": iconHTML = icoAttrib; break;
                default: iconHTML = icoOther; break;
            }

            // Set the inner HTML with the icon and text
            span.innerHTML = `${iconHTML} ${item.Name}`;

            // Label click handler
            span.addEventListener("click", (event) => {
                event.stopPropagation();
                showDetails(item);
                let childUl = li.querySelector("ul");
                if (childUl) {
                    let isExpanded = childUl.style.display === "block";
                    childUl.style.display = isExpanded ? "none" : "block";
                    toggleSpan.innerHTML = isExpanded ? icoTreeExp : icoTreeCol;
                    if (isExpanded) {
                        expandedNodes.delete(item.ElementKey);
                    } else {
                        expandedNodes.add(item.ElementKey);
                    }
                }
            });

            container.appendChild(toggleSpan);
            container.appendChild(span);
            li.appendChild(container);

            let children = database.filter(child => child.ParentKey === item.ElementKey);
            if (children.length > 0) {
                children.sort((a, b) => parseInt(a.Sort) - parseInt(b.Sort));

                let ul = document.createElement("ul");
                let isExpanded = expandedNodes.has(item.ElementKey);
                ul.style.display = isExpanded ? "block" : "none";

                // Set toggle visibility and label
                toggleSpan.innerHTML = isExpanded ? icoTreeCol : icoTreeExp;
                toggleSpan.style.cursor = "pointer";

                // Toggle click (same as span but just on the symbol)
                toggleSpan.addEventListener("click", (event) => {
                    event.stopPropagation();
                    let isNowExpanded = ul.style.display === "block";
                    ul.style.display = isNowExpanded ? "none" : "block";
                    toggleSpan.innerHTML = isNowExpanded ? icoTreeExp : icoTreeCol;
                    if (isNowExpanded) {
                        expandedNodes.delete(item.ElementKey);
                    } else {
                        expandedNodes.add(item.ElementKey);
                    }
                });

                children.forEach(child => ul.appendChild(createTreeNode(child)));
                li.appendChild(ul);
            }

            return li;
        }

        // Database Copying
        function openDatabaseModal() {
            const modal = document.getElementById('databaseModal');
            const textArea = document.getElementById('databaseText');

            // Make sure the latest database is stored
            let latestDatabase = JSON.parse(JSON.stringify(database)); // Deep clone to ensure correctness

            // Build compact JSON with newlines every elemLimit items
            let lines = [];
            for (let i = 0; i < latestDatabase.length; i += elemLimit) {
                let chunk = latestDatabase.slice(i, i + elemLimit);
                lines.push(JSON.stringify(chunk).slice(1, -1)); // Strip [ and ]
            }
            let formattedDatabase = `[\n  ${lines.join(",\n  ")}\n]`;

            textArea.value = "        let database = " + formattedDatabase + ";";
            modal.style.display = 'block';
        }

        function closeDatabaseModal() {
            document.getElementById('databaseModal').style.display = 'none';
        }

        function copyDatabase() {
            const textArea = document.getElementById('databaseText');
            textArea.select();
            document.execCommand("copy");
            alert("Database copied to clipboard!");
        }


        function isRegexString(str) {
            str = str.trim();

            // Shortcut: is it a valid /pattern/flags regex literal?
            const literalRegexPattern = /^\/(.|[\r\n])+\/[gimsuy]*$/;
            if (literalRegexPattern.test(str)) {
                try {
                    const lastSlash = str.lastIndexOf('/');
                    const pattern = str.slice(1, lastSlash);
                    const flags = str.slice(lastSlash + 1);
                    new RegExp(pattern, flags); // Confirm it's valid
                    return true;
                } catch (e) {
                    return false;
                }
            }

            // Fallback: does it *look like* a regex? Check for common regex features
            const likelyRegexFeatures = [
                /[\^\$\.\*\+\?\(\)\[\]\{\}\\]/,  // regex meta characters
                /\|/,                             // alternation
                /\(\?:/,                          // non-capturing group
                /\(\?=/,                          // positive lookahead
                /\(\?!/,                          // negative lookahead
            ];

            return likelyRegexFeatures.some((regex) => regex.test(str));
        }

        function isSpecialSyntax(str)
        {
            str = str.trim(); // Ensure no leading/trailing spaces
            const pattern = /^\[[a-zA-Z0-9_]+\]\(\([a-zA-Z0-9_]+\)\)/;
            const result = pattern.test(str);

            return result;
        }

        function escapeSpecialChars(str)
        {
            return str
                .replace(/[-\/\\^$+?.()|[\]{}]/g, "\\$&") // Escape special regex characters
                .replace(/\*/g, ".*"); // Convert * to .*
        }

        function showRegexLibrary() {
            const container = document.getElementById('regexTable');
            container.innerHTML = ''; // Clear previous content

            const table = document.createElement('table');
            table.style.borderCollapse = 'collapse';
            table.style.width = '100%';

            const header = document.createElement('tr');
            header.innerHTML = `
                <th style="border-bottom: 1px solid #ccc;"></th> <!-- + column -->
                <th style="border-bottom: 1px solid #ccc; text-align:left;">Description</th>
                <th style="border-bottom: 1px solid #ccc; text-align:left;">Regex</th>
            `;
            table.appendChild(header);

            regexLib.sort((a, b) => {
                // Compare the Description strings
                return a.Description.localeCompare(b.Description);
            });
            
            regexLib.forEach(entry => {
                const row = document.createElement('tr');
            
                // + Button Cell
                const buttonCell = document.createElement('td');
                buttonCell.style.padding = '4px';
            
                const addButton = document.createElement('button');
                addButton.textContent = '+';
                addButton.title = 'Insert into syntax field';
                addButton.onclick = () => {
                    const inputField = document.querySelector('input[type="text"]');
                    if (inputField) {
                        inputField.value = entry.Regex;
                        closeRegexLibrary();
                        inputField.focus();
                    }
                };
            
                buttonCell.appendChild(addButton);
            
                // Description and Regex Cells
                const descCell = document.createElement('td');
                descCell.style.padding = '4px';
                descCell.textContent = entry.Description;
            
                const regexCell = document.createElement('td');
                regexCell.style.padding = '4px';
                regexCell.style.fontFamily = 'monospace';
                regexCell.textContent = entry.Regex;
            
                // Append all cells in order
                row.appendChild(buttonCell);
                row.appendChild(descCell);
                row.appendChild(regexCell);
            
                table.appendChild(row);
            });

            container.appendChild(table);
            document.getElementById('regexDlg').style.display = 'block';
        }

        function closeRegexLibrary() {
            document.getElementById('regexDlg').style.display = 'none';
        }

        function showEditor(item, currentField)
        {
            editorContainer.innerHTML = `
                <div id="editor-close">X</div>
                <textarea id="editor"></textarea>
            `;

            let editor = document.getElementById("editor");
            let editorClose = document.getElementById("editor-close");
            document.getElementById("details").style.display = "none";
            document.getElementById("editor-container").style.display = "flex";
            const btn = document.getElementById("editor-close");

            switch (currentField)
            {
                case "logic":
                    if (item.Logic == null)
                    {
                        editor.value = "";
                    }
                    else
                    {
                        editor.value = item.Logic;
                    }
                    break;
                case "output":
                    if (item.Output == null)
                    {
                        editor.value = "";
                    }
                    else
                    {
                        editor.value = item.Output;
                    }
                    break;
            }
            editor.focus();

            editor.addEventListener("keydown", function(event) {
                if (event.key === "Escape") {
                    switch (currentField)
                    {
                        case "logic":
                            item.Logic = editor.value;
                            break;
                        case "output":
                            item.Output = editor.value;
                            break;
                    }
                    closeEditor(item);
                }
            });
            btn.addEventListener("click", function(event) {
                switch (currentField)
                {
                    case "logic":
                        item.Logic = editor.value;
                        break;
                    case "output":
                        item.Output = editor.value;
                        break;
                }
                closeEditor(item);
            });
        }

        function closeEditor(item)
        {
            document.getElementById("details").style.display = "block";
            document.getElementById("editor-container").style.display = "none";
            showDetails(item);
            adminInput.focus();  // Focus the admin input field
        }

        // !@! details
        function showDetails(item)
        {
            currentParent = item.ElementKey;
            
            let parentDropdown = `<select id="parentSelect">`;
            parentDropdown += `<option value="null" ${item.ParentKey === null ? "selected" : ""}>No Parent</option>`;
            database.forEach(otherItem => {
                if (otherItem.ElementKey !== item.ElementKey && otherItem.ElementType !== "attribute") {
                    parentDropdown += `<option value="${otherItem.ElementKey}" ${item.ParentKey === otherItem.ElementKey ? "selected" : ""}>${otherItem.Name}</option>`;
                }
            });
            parentDropdown += `</select>`;

            details.innerHTML = `
                <p><strong>Element Type:</strong><span id="element-type-parent"><span id="element-type" class="link">${item.ElementType || "Click to Edit"}</span></span></p>
                <p><strong>Element Key:</strong> <span id="element-key" class="link">${item.ElementKey}</span></p>
                <p><strong>Name:</strong> <span id="element-name" class="link">${item.Name || "Click to Edit"}</span></p>
                <!--p><strong>Parent Key:</strong> ${(item.ElementType != "game") ? parentDropdown : ""}</p -->
                <p><strong>Syntax:</strong> <span id="syntax-caption" class="link">${item.Syntax || "Click to Edit"}</span></p>
                <p><strong>Logic:</strong> <span id="logic-field" class="link">${item.Logic || "Click to View/Edit"}</span></p>
                <p><strong>Output:</strong> <span id="output-field" class="link">${(item.Output && item.Output.length > 100) ? item.Output.substring(0, 100)+"..." : item.Output || "Click to View/Edit"}</span></p>
                <p><strong>Tags:</strong> <span id="tags-field" class="link">${item.Tags || "Click to Edit"}</span></p>
                <p><strong>Repeat:</strong> <span id="repeat-field-parent"><span id="repeat-field" class="link">${item.Repeat || "Click to Edit"}</span><span></p>
                <p><strong>Active:</strong> <span><input id="element-active" type="checkbox" ${(item.Active === "true") ? "checked" : ""} /></span></p>
                <p><strong>Sort:</strong> <span id="sort-field" class="link">${item.Sort || "Click to Edit"}</span></p>
                <br />
                <p><span id="delete-element" class="link">Delete</span></p>
            `;

            document.getElementById("element-active").addEventListener("change", function() {
                if (document.getElementById("element-active").checked) {
                    item.Active = "true";
                } else {
                    item.Active = "false";
                }
            });

            // Handle inline editing for ElementKey
            document.getElementById("element-key").addEventListener("click", function() {
                let inputField = document.createElement("input");
                inputField.type = "text";
                inputField.value = item.ElementKey;
                inputField.style = "width: 200px";
                inputField.select();

                inputField.addEventListener("keypress", function(event) {
                    if (event.key === "Enter") {
                        let oldKey = item.ElementKey;
                        let newKey = inputField.value.trim();

                        if (newKey == "")
                        {
                            newKey = getGuid();
                        }

                        newKey = newKey.replace(" ", "_");
                        
                        if (newKey && !database.some(entry => entry.ElementKey === newKey))
                        {
                            let children = database.filter(item => item.ParentKey === oldKey);

                            for (child of children)
                            {
                                child.ParentKey = newKey;
                            }

                            // Update ElementKey in the database
                            item.ElementKey = newKey;
                            buildTreeView(true); // Rebuild tree view
                        }
                        
                        // Restore original ElementKey if not unique
                        showDetails(item);
                    }
                });

                inputField.addEventListener("keydown", function(event) {
                    if (event.key === "Escape") {
                        showDetails(item);
                    }
                });

                this.replaceWith(inputField);
                inputField.focus();
            });

            function showEditField(currItem, fieldName)
            {
                let parent = null;
                let textField = null;
                let inputField = document.createElement("input");
                inputField.type = "text";
                inputField.inputmode="text"

                switch(fieldName)
                {
                    case "name":
                        inputField.value = item.Name;
                        inputField.style = "width: 200px";
                        break;
                    case "sort":
                        inputField.type = "number";
                        inputField.value = item.Sort;
                        inputField.style = "width: 50px";
                        break;
                    case "tags":
                        inputField.value = item.Tags;
                        inputField.style = "width: 500px";
                        break;
                    case "repeat":
                        inputField = document.createElement("select");
                        const options = ["none", "random", "repeat", "other"];
                        options.forEach(option => {
                            let opt = document.createElement("option");
                            opt.value = option;
                            opt.textContent = option;
                            inputField.appendChild(opt);
                        });
                        inputField.value = item.Repeat;
                        parent = document.getElementById("repeat-field-parent");
                        
                        textField = document.createElement("input");
                        textField.type = "text";
                        textField.style.width = "100px";
                        
                        inputField.addEventListener("change", function() {
                            if (inputField.value === "other") {
                                if (parent) {
                                    parent.replaceChild(textField, inputField); // Replace dropdown with textbox
                                }
                                textField.value = item.Repeat;
                                textField.focus();
                                textField.select();

                                textField.addEventListener("keydown", function(event) {
                                    if (event.key === "Enter") {
                                        item.Repeat = textField.value.trim();
                                        buildTreeView(true);
                                        showDetails(item);
                                        return;
                                    }
                                    if (event.key === "Escape") {
                                        showDetails(item);
                                    }
                                });
                            } else {
                                item.Repeat = inputField.value;
                                buildTreeView(true);
                                showDetails(item);
                                return;
                            }
                        });
                        break;
                    case "type":
                        if (item.ElementType === "game" || item.ElementType === "player") {
                            showDetails(item);
                        }
                        inputField = document.createElement("select");
                        inputField.style.width = "200px";
                        elementTypes.forEach(option => {
                            let opt = document.createElement("option");
                            opt.value = option;
                            opt.textContent = option;
                            inputField.appendChild(opt);
                        });
                        inputField.value = item.ElementType;
                        parent = document.getElementById("element-type-parent");
                        
                        textField = document.createElement("input");
                        textField.type = "text";
                        textField.style.width = "200px";
                        
                        inputField.addEventListener("change", function() {
                            if (inputField.value === "custom") {
                                if (parent) {
                                    parent.replaceChild(textField, inputField); // Replace dropdown with textbox
                                }
                                textField.value = item.ElementType;
                                textField.focus();
                                textField.select();

                                textField.addEventListener("keydown", function(event) {
                                    if (event.key === "Enter") {
                                        item.ElementType = textField.value.trim();
                                        buildTreeView(true);
                                        showDetails(item);
                                        return;
                                    }
                                    if (event.key === "Escape") {
                                        showDetails(item);
                                    }
                                });
                            } else {
                                item.ElementType = inputField.value;
                                buildTreeView(true);
                                showDetails(item);
                                return;
                            }
                        });
                        break;
                }

                try {
                    inputField.select();
                }
                catch(err) {
                    // select not possible - likely due to it being a drop down
                }

                inputField.addEventListener("keypress", function(event) {
                    if (event.key === "Enter") {

                        switch(fieldName)
                        {
                            case "name":
                                item.Name = inputField.value.trim();
                                break;
                            case "sort":
                                item.Sort = inputField.value.trim();
                                break;
                            case "tags":
                                item.Tags = inputField.value.trim();
                                break;
                            case "repeat":
                                item.Repeat = inputField.value === "other" ? textField.value.trim() : inputField.value;
                                break;
                            case "type":
                                item.ElementType = inputField.value === "custom" ? textField.value.trim() : inputField.value;
                                break;
                        }

                        buildTreeView(true);
                        showDetails(item);
                    }
                });

                inputField.addEventListener("keydown", function(event) {
                    if (event.key === "Escape") {
                        showDetails(item);
                    }
                });

                currItem.replaceWith(inputField);
                inputField.focus();
            }

            // !@! delete
            function deleteElement(elementKey) {
                // Find all children of the element
                let children = database.filter(el => el.ParentKey === elementKey);

                // Recursively delete each child first
                for (let child of children) {
                    deleteElement(child.ElementKey);
                }

                // Now remove the element itself
                let index = database.findIndex(el => el.ElementKey === elementKey);
                if (index !== -1) {
                    database.splice(index, 1);
                }
            }

            // Handle inline editing for ElementType
            document.getElementById("element-type").addEventListener("click", function() {
                showEditField(this, "type");
            });

            // Handle inline editing for ElementName
            document.getElementById("element-name").addEventListener("click", function() {
                showEditField(this, "name");
            });

            // Handle inline editing for Tags
            document.getElementById("tags-field").addEventListener("click", function() {
                showEditField(this, "tags");
            });

            // Handle inline editing for Sort
            document.getElementById("sort-field").addEventListener("click", function() {
                showEditField(this, "sort");
            });

            // Handle inline editing for Repeat
            document.getElementById("repeat-field").addEventListener("click", function() {
                showEditField(this, "repeat");
            });

            // Add event listener for syntax caption click
            document.getElementById("syntax-caption").addEventListener("click", function() {
                let inputField = document.createElement("input");
                inputField.type = "text";
                inputField.value = item.Syntax || "";
                inputField.style = "width: 300px";

                const regexBtn = document.createElement('button');
                regexBtn.textContent = 'View All Regex';
                regexBtn.onclick = showRegexLibrary;

                inputField.select();
                inputField.addEventListener("keydown", function(event) {
                    if (event.key === "Enter") {
                        let inputText = inputField.value.trim();
                        if (inputText)
                        {
                            try {
                                if (isRegexString(inputText)) {
                                    item.Syntax = inputText;
                                    showDetails(item);
                                    return;
                                }

                                // If input is special syntax, store it as-is and exit
                                if (isSpecialSyntax(inputText)) {
                                    item.Syntax = inputText;
                                    showDetails(item);
                                    return; // Exit event listener
                                }

                                // Otherwise, process normally (escape and wildcard handling)
                                let escapedInput = inputText
                                    .split("|")
                                    .map(part => part.trim())
                                    .map(part => escapeSpecialChars(part)) // Escape regex special characters
                                    .join("|");

                                // Construct the regex string
                                let regexString = `(${escapedInput})`; // Match whole words
                                item.Syntax = regexString;

                                showDetails(item); // Update details view
                            } catch (error) {
                                alert("Error generating regex: " + error.message);
                            }
                        }
                        else
                        {
                            item.Syntax = "";
                            showDetails(item);
                        }

                    }
                });
                inputField.addEventListener("keydown", function(event) {
                    if (event.key === "Escape") {
                        showDetails(item);
                    }
                });

                const container = document.createElement("div");
                container.style.display = "flex";
                container.style.alignItems = "center";
                container.style.marginTop = "6px";
                container.style.gap = "0.5em";
                
                container.appendChild(inputField);
                container.appendChild(regexBtn);


                // Replace the caption with the input field
                this.replaceWith(container);
                inputField.focus();  // Focus on the input field
            });

            // Update parent key when selection changes
            if (document.getElementById("parentSelect")) {
                document.getElementById("parentSelect").addEventListener("change", function() {
                    let newParentKey = this.value === "null" ? null : this.value;
                    if (item.ParentKey !== newParentKey) {
                        item.ParentKey = newParentKey;
                        buildTreeView(true); // Rebuild the tree view after the parent key change
                    }
                });
            }

            document.getElementById("logic-field").addEventListener("click", function() {
                showEditor(item, "logic");
            });

            document.getElementById("output-field").addEventListener("click", function() {
                showEditor(item, "output");
            });

            // Handle delete
            document.getElementById("delete-element").addEventListener("click", function() {
                deleteElement(item.ElementKey);
                buildTreeView(true);
                details.innerHTML = "Select an item to see details.";
                adminInput.focus();
            });

            adminInput.focus();  // Focus the admin input field
        }

        // Events
        adminInput.addEventListener("keypress", function(event) {
            if (event.key === "Enter") {
                let command = adminInput.value.trim();
                if (command) {
                    processAdminInput(command);
                }
                adminInput.value = "";
            }
        });
        window.onload = function() {
            // Ensure the database is not overwritten if it was injected from a saved file
            if (!Array.isArray(database) || database.length === 0) {
                database = [];
                createNewElement("game", "game", "Game", false, false);
                createNewElement("player", "player", "Player", false, false);
            }

            enterAdminMode();
        };
    </script>
</body></html>
